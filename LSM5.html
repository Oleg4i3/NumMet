<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSM</title>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script>window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };</script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        /* GLOBAL STYLES */
        body { font-family: 'Segoe UI', Roboto, sans-serif; background: #eaeff2; margin: 0; padding: 0; color: #34495e; height: 100vh; display: flex; flex-direction: column; }
        .header { background: #2c3e50; color: #ecf0f1; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
        .header h2 { margin: 0; font-size: 1.3rem; }
        
        /* TABS NAVIGATION */
        .tabs { display: flex; background: #34495e; padding: 0 20px; gap: 4px; flex-shrink: 0; }
        .tab-btn { padding: 10px 20px; cursor: pointer; border: none; background: #2c3e50; color: #bdc3c7; font-weight: 600; border-radius: 5px 5px 0 0; transition: all 0.2s; }
        .tab-btn:hover { background: #3e5871; color: white; }
        .tab-btn.active { background: #eaeff2; color: #2c3e50; border-top: 3px solid #3498db; }

        /* CONTENT AREAS */
        .tab-content { display: none; height: calc(100vh - 90px); width: 100%; overflow: hidden; }
        .tab-content.active { display: flex; }
        
        .left-panel { flex: 0 0 380px; background: #fdfdfd; border-right: 1px solid #bdc3c7; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; z-index: 5; }
        .right-panel { flex: 1; position: relative; background: white; overflow: hidden; }

        /* UI ELEMENTS */
        .story-box { padding: 12px; border-radius: 6px; font-size: 0.9em; line-height: 1.4; border-left: 4px solid #7f8c8d; background: #ecf0f1; }
        .math-box { background: white; border: 1px solid #bdc3c7; padding: 10px; border-radius: 6px; font-size: 0.85em; text-align: center; }
        .control-group { background: white; padding: 15px; border-radius: 8px; border: 1px solid #dcdcdc; }
        .control-group h4 { margin: 0 0 10px 0; border-bottom: 2px solid #3498db; display: inline-block; color: #2c3e50; }
        
        .slider-wrapper { margin-bottom: 8px; }
        .slider-wrapper label { display: flex; justify-content: space-between; font-size: 0.85em; font-weight: bold; color: #555; }
        input[type=range] { width: 100%; margin: 5px 0; cursor: pointer; }
        
        button { width: 100%; padding: 10px; margin-top: 5px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        button.primary { background: #3498db; color: white; }
        button.primary:hover { background: #2980b9; }
        button.secondary { background: #95a5a6; color: white; }
        
        .error-display { text-align: center; font-family: monospace; font-weight: bold; color: #c0392b; background: #fadbd8; padding: 8px; border-radius: 4px; border: 1px solid #e74c3c; margin-top: auto; }
        .status-msg { margin-top: 10px; padding: 10px; border-radius: 4px; font-size: 0.85em; display: none; }
        .status-success { background: #d4efdf; color: #1e8449; border: 1px solid #27ae60; }
        .status-fail { background: #fcf3cf; color: #7f6000; border: 1px solid #f1c40f; }

        /* PLOTS */
        #plot1, #plot3 { width: 100%; height: 100%; }
        #gd-plot { width: 100%; height: 150px; margin-top: 10px; border: 1px solid #eee; display:none; }
        #asteroid-container { width: 100%; height: 100%; background: #000; }
        #asteroid-overlay { position: absolute; top: 10px; left: 10px; color: #0f0; font-family: monospace; pointer-events: none; background: rgba(0,0,0,0.6); padding: 10px; border-radius: 4px; font-size: 12px; }
    </style>
</head>
<body>

<div class="header">

   <details style="background: #fff; border: 1px solid #bdc3c7; border-radius: 5px; padding: 4px; margin: 4px 4px; box-shadow: 0 2px 3px rgba(0,0,0,0.05);">
    <summary style="cursor: pointer; font-weight: bold; color: #2c3e50; outline: none;">–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –¥–æ–≤—ñ–¥–∫–∞: –ú–µ—Ç–æ–¥ –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤</summary>
    
    <div style="margin-top: 15px; color: #34495e; line-height: 1.6;">
        <p><b>–ú–µ—Ç–æ–¥ –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ (–ú–ù–ö)</b> ‚Äî —Ü–µ —á–∏—Å–µ–ª—å–Ω–∏–π –º–µ—Ç–æ–¥ –∞–ø—Ä–æ—É—Å–∏–º–∞—Ü—ñ—ó, –º–µ—Ç–∞ —è–∫–æ–≥–æ ‚Äî –∑–Ω–∞–π—Ç–∏ —Ç–∞–∫—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ, –ø—Ä–∏ —è–∫–∏—Ö —Å—É–º–∞ –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –≤—ñ–¥—Ö–∏–ª–µ–Ω—å (–Ω–µ–≤'—è–∑–æ–∫) –º—ñ–∂ –¥–∞–Ω–∏–º–∏ —Ç–∞ –º–æ–¥–µ–ª–ª—é —î –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—é.</p>
        
        <div style="background: #f8f9fa; border-left: 4px solid #3498db; padding: 10px; margin: 10px 0;">
            $$ S(\vec{p}) = \sum_{i=1}^{N} (y_i - f(x_i, \vec{p}))^2 \rightarrow \min $$
        </div>
		<p>–ó–∞–∑–≤–∏—á–∞–π –º—ñ–Ω—ñ–º—ñ–∑—É—é—Ç—å —Å—É–º—É –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ –ø–æ–º–∏–ª–∫–∏ –º–æ–¥–µ–ª—ñ (Sum square error, SSM), –∞–±–æ —Å–µ—Ä–µ–¥–Ω—ñ–π –∫–≤–∞–¥—Ä–∞—Ç –ø–æ–º–∏–ª–∫–∏ (Mean square error, MSE) </p>
       
        <h4>1. –õ—ñ–Ω—ñ–π–Ω—ñ —Ç–∞ –ø–æ–ª—ñ–Ω–æ–º—ñ–∞–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ (–ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–π —Ä–æ–∑–≤'—è–∑–æ–∫)</h4>
        <p>–î–ª—è –º–æ–¥–µ–ª–µ–π, —è–∫—ñ —î <b>–ª—ñ–Ω—ñ–π–Ω–∏–º–∏ –∑–∞ —Å–≤–æ—ó–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</b> (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä—è–º–∞ $y=ax+b$ –∞–±–æ –ø–∞—Ä–∞–±–æ–ª–∞ $y=ax^2+bx+c$), –∑–∞–¥–∞—á–∞ –º—ñ–Ω—ñ–º—ñ–∑–∞—Ü—ñ—ó –∑–≤–æ–¥–∏—Ç—å—Å—è –¥–æ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è <b>–°–∏—Å—Ç–µ–º–∏ –ª—ñ–Ω—ñ–π–Ω–∏—Ö –∞–ª–≥–µ–±—Ä–∞—ó—á–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å (–°–õ–ê–†)</b>.</p>
        <ul>
            <li>–ú–∏ –±–µ—Ä–µ–º–æ —á–∞—Å—Ç–∏–Ω–Ω—ñ –ø–æ—Ö—ñ–¥–Ω—ñ –≤—ñ–¥ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–æ–º–∏–ª–∫–∏ $S$ –ø–æ –∫–æ–∂–Ω–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É —ñ –ø—Ä–∏—Ä—ñ–≤–Ω—é—î–º–æ —ó—Ö –¥–æ –Ω—É–ª—è.</li>
            <li>–û—Ç—Ä–∏–º—É—î–º–æ —Å–∏—Å—Ç–µ–º—É –Ω–æ—Ä–º–∞–ª—å–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å, —è–∫—É –º–æ–∂–Ω–∞ —Ä–æ–∑–≤'—è–∑–∞—Ç–∏ —Ç–æ—á–Ω–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –º–µ—Ç–æ–¥–æ–º –ì–∞—É—Å–∞).</li>
            <li><b>–£ —Å–∏–º—É–ª—è—Ç–æ—Ä—ñ:</b> –í–∫–ª–∞–¥–∫–∞ 1 (–õ—ñ–Ω—ñ–π–Ω–∞, –ü–∞—Ä–∞–±–æ–ª–∞). –ö–Ω–æ–ø–∫–∞ "–ó–Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–æ" –º–∏—Ç—Ç—î–≤–æ –≤–∏–¥–∞—î —ñ–¥–µ–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –æ—Å–∫—ñ–ª—å–∫–∏ –ø–æ–≤–µ—Ä—Ö–Ω—è –ø–æ–º–∏–ª–∫–∏ –º–∞—î —î–¥–∏–Ω–∏–π –≥–ª–æ–±–∞–ª—å–Ω–∏–π –º—ñ–Ω—ñ–º—É–º (–ø–∞—Ä–∞–±–æ–ª–æ—ó–¥).</li>
        </ul>
		
		<details>
		 <summary><strong>üîç –Ø–∫ —Å–∞–º–µ –∑'—è–≤–ª—è—î—Ç—å—Å—è –°–õ–ê–†?</strong></summary> 
       
        <p>–†–æ–∑–≥–ª—è–Ω–µ–º–æ —Ü–µ –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ –ª—ñ–Ω—ñ–π–Ω–æ—ó –º–æ–¥–µ–ª—ñ $y = ax + b$, –¥–µ –º–∏ —à—É–∫–∞—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ $a$ —Ç–∞ $b$:</p>
        
        <div style="background: white; border: 1px dashed #bdc3c7; padding: 15px; border-radius: 4px; font-size: 0.95em;">
            <b>–ö—Ä–æ–∫ 1.</b> –ó–∞–ø–∏—Å—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏:
            $$ S(a, b) = \sum_{i=1}^{n} (y_i - (ax_i + b))^2 $$
            
            <b>–ö—Ä–æ–∫ 2.</b> –ó–Ω–∞—Ö–æ–¥–∏–º–æ —á–∞—Å—Ç–∏–Ω–Ω—ñ –ø–æ—Ö—ñ–¥–Ω—ñ —Ç–∞ –ø—Ä–∏—Ä—ñ–≤–Ω—é—î–º–æ —ó—Ö –¥–æ –Ω—É–ª—è:
            $$ 
            \begin{cases} 
                \frac{\partial S}{\partial a} = \sum 2(y_i - ax_i - b) \cdot (-x_i) = 0 \\ 
                \frac{\partial S}{\partial b} = \sum 2(y_i - ax_i - b) \cdot (-1) = 0 
            \end{cases} 
            $$
            
            <b>–ö—Ä–æ–∫ 3.</b> –†–æ–∑–∫—Ä–∏–≤–∞—î–º–æ –¥—É–∂–∫–∏, —Å–∫–æ—Ä–æ—á—É—î–º–æ –Ω–∞ $-2$ —Ç–∞ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ –≤—ñ–¥–æ–º—ñ —Å—É–º–∏ –ø—Ä–∞–≤–æ—Ä—É—á:
            $$ 
            \begin{cases} 
                a \sum x_i^2 + b \sum x_i = \sum x_i y_i \\ 
                a \sum x_i + b \cdot n = \sum y_i 
            \end{cases} 
            $$
        </div>
        <p style="margin-top:10px;">–û—Ç—Ä–∏–º–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è <b>—Å–∏—Å—Ç–µ–º–æ—é –Ω–æ—Ä–º–∞–ª—å–Ω–∏—Ö —Ä—ñ–≤–Ω—è–Ω—å</b>. –û—Å–∫—ñ–ª—å–∫–∏ $\sum x_i$, $\sum x_i^2$ —Ç–∞ $\sum x_i y_i$ ‚Äî —Ü–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞, –æ–±—á–∏—Å–ª–µ–Ω—ñ –∑ –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö, –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –∫–ª–∞—Å–∏—á–Ω—É –°–õ–ê–†, —è–∫—É –ª–µ–≥–∫–æ —Ä–æ–∑–≤'—è–∑–∞—Ç–∏.</p>
		</details>	


        <h4>2. –ù–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ, —â–æ –ª—ñ–Ω–µ–∞—Ä–∏–∑—É—é—Ç—å—Å—è</h4>
        <p>–î–µ—è–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤–∏–≥–ª—è–¥–∞—é—Ç—å –Ω–µ–ª—ñ–Ω—ñ–π–Ω–∏–º–∏, –∞–ª–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–≤–µ–¥–µ–Ω—ñ –¥–æ –ª—ñ–Ω—ñ–π–Ω–∏—Ö —à–ª—è—Ö–æ–º –∑–∞–º—ñ–Ω–∏ –∑–º—ñ–Ω–Ω–∏—Ö.</p>
        <ul>
            <li><b>–ü—Ä–∏–∫–ª–∞–¥ (Log):</b> $y = a \cdot \ln(x) + b$. –Ø–∫—â–æ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–º—ñ–Ω—É $t = \ln(x)$, –æ—Ç—Ä–∏–º–∞—î–º–æ –ª—ñ–Ω—ñ–π–Ω–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è $y = a \cdot t + b$.</li>
            <li>–¶–µ –¥–æ–∑–≤–æ–ª—è—î —Ç–∞–∫–æ–∂ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —Ç–æ—á–Ω–∏–π –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–π –º–µ—Ç–æ–¥ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –°–õ–ê–†.</li>
        </ul>

        <h4>3. –°—É—Ç—Ç—î–≤–æ –Ω–µ–ª—ñ–Ω—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ (–ß–∏—Å–µ–ª—å–Ω—ñ –º–µ—Ç–æ–¥–∏)</h4>
        <p>–Ø–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤—Ö–æ–¥—è—Ç—å —É —Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏–º —á–∏–Ω–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ–¥ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ç—É –∞–±–æ —Å–∏–Ω—É—Å: $y = A e^{-\lambda x} \sin(\omega x)$), –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–æ –≤–∏—Ä–∞–∑–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —á–µ—Ä–µ–∑ –°–õ–ê–† –Ω–µ–º–æ–∂–ª–∏–≤–æ. –¢—É—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —ñ—Ç–µ—Ä–∞—Ü—ñ–π–Ω—ñ –º–µ—Ç–æ–¥–∏, —Ç–∞–∫—ñ —è–∫ <b>–ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π —Å–ø—É—Å–∫ (Gradient Descent)</b>.</p>
        
        <p><b>–ê–ª–≥–æ—Ä–∏—Ç–º:</b></p>
        <ol>
            <li>–û–±–∏—Ä–∞—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –≤–∏–ø–∞–¥–∫–æ–≤–æ –∞–±–æ –≤—Ä—É—á–Ω—É (Initial Guess).</li>
            <li>–û–±—á–∏—Å–ª—é—î–º–æ –≥—Ä–∞–¥—ñ—î–Ω—Ç —Ñ—É–Ω–∫—Ü—ñ—ó –ø–æ–º–∏–ª–∫–∏ (–Ω–∞–ø—Ä—è–º–æ–∫ –Ω–∞–π—à–≤–∏–¥—à–æ–≥–æ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏).</li>
            <li>–ó–º—ñ–Ω—é—î–º–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–æ–º—É –Ω–∞–ø—Ä—è–º–∫—É (—â–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ –ø–æ–º–∏–ª–∫—É): 
                $$ \vec{p}_{new} = \vec{p}_{old} - \alpha \cdot \nabla S $$
            </li>
            <li>–ü–æ–≤—Ç–æ—Ä—é—î–º–æ –ø—Ä–æ—Ü–µ—Å –¥–æ –∑–±—ñ–∂–Ω–æ—Å—Ç—ñ.</li>
        </ol>

        <div style="background: #fff3cd; border: 1px solid #ffeeba; padding: 10px; border-radius: 4px; margin-top: 10px;">
            <b>‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ –ª–æ–∫–∞–ª—å–Ω–∏—Ö –º—ñ–Ω—ñ–º—É–º—ñ–≤:</b>
            <p style="margin: 5px 0 0 0; font-size: 0.9em;">
                –§—É–Ω–∫—Ü—ñ—è –ø–æ–º–∏–ª–∫–∏ —Å–∫–ª–∞–¥–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π –º–æ–∂–µ –º–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –ª–æ–∫–∞–ª—å–Ω–∏—Ö –º—ñ–Ω—ñ–º—É–º—ñ–≤. –Ø–∫—â–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –∑ –Ω–µ–≤–¥–∞–ª–æ—ó –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó —Ç–æ—á–∫–∏, –≤—ñ–Ω –º–æ–∂–µ "–∑–∞—Å—Ç—Ä—è–≥—Ç–∏" –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä–æ–∑–≤'—è–∑–∫—É.
                <br><br>
                <b>–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä—ñ:</b> –î–ª—è "–ó–≥–∞—Å–∞—é—á–æ–≥–æ —Å–∏–Ω—É—Å–∞" (–í–∫–ª–∞–¥–∫–∞ 1), "–ê—Å—Ç–µ—Ä–æ—ó–¥–∞" (–í–∫–ª–∞–¥–∫–∞ 2) —Ç–∞ "–ü–∞–Ω–¥–µ–º—ñ—ó" (–í–∫–ª–∞–¥–∫–∞ 3) –≤–∞–∂–ª–∏–≤–æ —Å–ø–µ—Ä—à—É <b>–≤—Ä—É—á–Ω—É –ø–æ–≤–∑—É–Ω–∫–∞–º–∏</b> –Ω–∞–±–ª–∏–∑–∏—Ç–∏ –º–æ–¥–µ–ª—å –¥–æ –¥–∞–Ω–∏—Ö. –¶–µ –ø–æ–º—ñ—â–∞—î –∞–ª–≥–æ—Ä–∏—Ç–º –≤ –æ–±–ª–∞—Å—Ç—å —Ç—è–∂—ñ–Ω–Ω—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –º—ñ–Ω—ñ–º—É–º—É, –ø—ñ—Å–ª—è —á–æ–≥–æ –∫–Ω–æ–ø–∫–∞ "–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è" –∑–º–æ–∂–µ –∑–Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–∏–π —Ä–æ–∑–≤'—è–∑–æ–∫.
            </p>
        </div>
    </div>
</details>

</div>

<div class="tabs">
    <button class="tab-btn active" onclick="app.openTab('tab1')">1. –ú–æ–¥–µ–ª—ñ</button>
    <button class="tab-btn" onclick="app.openTab('tab2')">2. –ê—Å—Ç–µ—Ä–æ—ó–¥</button>
    <button class="tab-btn" onclick="app.openTab('tab3')">3. –ü–∞–Ω–¥–µ–º—ñ—è</button>
</div>




<div id="tab1" class="tab-content active">
    <div class="left-panel">
        <div class="story-box">
            <b>–ó–∞–≤–¥–∞–Ω–Ω—è:</b> –í—ñ–¥–Ω–æ–≤—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ (–ú–ù–ö).
            <ul style="padding-left:15px; margin:5px 0;">
                <li>–ß–µ—Ä–≤–æ–Ω—ñ –∫–≤–∞–¥—Ä–∞—Ç–∏ ‚Äî —Ü–µ –≥–µ–æ–º–µ—Ç—Ä–∏—á–Ω–∞ —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—è –ø–æ–º–∏–ª–∫–∏ $(y_{obs} - y_{model})^2$.</li>
                <li><b>–õ—ñ–Ω—ñ–π–Ω–∞, –ü–∞—Ä–∞–±–æ–ª–∞, Log:</b> –º–∞—é—Ç—å —Ç–æ—á–Ω–∏–π –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–π —Ä–æ–∑–≤'—è–∑–æ–∫.</li>
                <li><b>–°–∏–Ω—É—Å:</b> –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —á–∏—Å–µ–ª—å–Ω–∏–π –º–µ—Ç–æ–¥ (–≥—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π —Å–ø—É—Å–∫).</li>
            </ul>
        </div>

        <div class="control-group">
            <h4>1. –í–∏–±—ñ—Ä –º–æ–¥–µ–ª—ñ</h4>
            <select id="t1-model" onchange="Mod1.onModelChange()" style="width:100%; padding:8px; margin-bottom:10px;">
                <option value="linear">–õ—ñ–Ω—ñ–π–Ω–∞ (y = ax + b)</option>
                <option value="parabola">–ü–∞—Ä–∞–±–æ–ª–∞ (y = ax¬≤ + bx + c)</option>
                <option value="log">–õ–æ–≥–∞—Ä–∏—Ñ–º (y = a¬∑ln(x) + b)</option>
                <option value="damped" selected>–ó–≥–∞—Å–∞—é—á–∏–π —Å–∏–Ω—É—Å (–°–∫–ª–∞–¥–Ω–∞)</option>
            </select>
            <div class="math-box" id="t1-math">$$ y = A e^{-\lambda x} \sin(\omega x) $$</div>
            <button onclick="Mod1.addRandom()" class="secondary">üé≤ –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Ç–æ—á–∫–∏</button>
        </div>

        <div class="control-group">
            <h4>2. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏</h4>
            <div class="slider-wrapper"><label><span id="lbl-p1">A</span> <span id="val-p1">0</span></label><input type="range" id="sl-p1" oninput="Mod1.onSliderInput()"></div>
            <div class="slider-wrapper"><label><span id="lbl-p2">w</span> <span id="val-p2">0</span></label><input type="range" id="sl-p2" oninput="Mod1.onSliderInput()"></div>
            <div class="slider-wrapper" id="wrap-p3"><label><span id="lbl-p3">lam</span> <span id="val-p3">0</span></label><input type="range" id="sl-p3" oninput="Mod1.onSliderInput()"></div>
            
            <button onclick="Mod1.solve()" class="primary" id="btn-t1-solve">‚ö° –ó–Ω–∞–π—Ç–∏ —Ä–æ–∑–≤'—è–∑–æ–∫</button>
        </div>

        <div id="gd-plot"></div>
        
        <div id="t1-msg-box" style="display:none; margin-top:10px; padding:10px; border-radius:4px; font-size:0.9em;"></div>

        <div class="error-display" id="t1-mse">MSE: 0.00</div>
    </div>
    <div class="right-panel">
        <div id="plot1"></div>
    </div>
</div>





<div id="tab2" class="tab-content">
    <div class="left-panel">
        <div class="story-box" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); color:white; border-left-color:#f1c40f;">
            <span style="display:block; font-weight:bold; margin-bottom:5px;">–ü–û–Ø–° –ê–°–¢–ï–†–û–á–î–Ü–í</span>
            –°–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–Ω—å–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –∑–∞—Ñ—ñ–∫—Å—É–≤–∞–ª–∞ –∫–∞–º'—è–Ω—ñ —É–ª–∞–º–∫–∏. <br>
            <b>–ó–∞–≤–¥–∞–Ω–Ω—è:</b> –í–∏–∑–Ω–∞—á–∏—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –µ–ª—ñ–ø—Ç–∏—á–Ω–æ—ó –æ—Ä–±—ñ—Ç–∏, –≤–∑–¥–æ–≤–∂ —è–∫–æ—ó —Ä—É—Ö–∞–≤—Å—è –∑—Ä—É–π–Ω–æ–≤–∞–Ω–∏–π –æ–±'—î–∫—Ç. –¢—Ä–µ–±–∞ –ø—ñ–¥—ñ–±—Ä–∞—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –¥—Ä—É–≥–æ–≥–æ —Ñ–æ–∫—É—Å–∞ –µ–ª—ñ–ø—Å–∞ ($F_2$) —ñ –Ω–∞—Ö–∏–ª –ø–ª–æ—â–∏–Ω–∏ –æ—Ä–±—ñ—Ç–∏. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —á–∏—Å–µ–ª—å–Ω–∏–π –ø–æ—à—É–∫ —á–∞—Å—Ç–æ "–∑–∞—Å—Ç—Ä—è–≥–∞—î" –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –º—ñ–Ω—ñ–º—É–º—ñ –∞–±–æ –Ω–∞ –∫—Ä–∞—é –¥—ñ–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω—å. "–î–æ–ø–æ–º–æ–∂—ñ—Ç—å" –π–æ–º—É, –≤–∏—Å—Ç–∞–≤–∏–≤—à–∏ –ø—Ä–∏–±–ª–∏–∑–Ω—É –æ—Ä–±—ñ—Ç—É –≤—Ä—É—á–Ω—É.
        </div>

        <div class="math-box">
            <b>–ù–µ–≤'—è–∑–∫–∞ (Residual):</b> –ù–∞–π–∫–æ—Ä–æ—Ç—à–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –≤—ñ–¥ —Ç–æ—á–∫–∏ $P_i$ –¥–æ –∫—Ä–∏–≤–æ—ó:
            $$ d_i = \min_{t} || P_i - \vec{r}(t) || $$
            –ú–∏ –º—ñ–Ω—ñ–º—ñ–∑—É—î–º–æ $\sum d_i^2$.
			
		
		<details>
<summary><strong>–¢–æ—á–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∞ —Ñ–æ—Ä–º–∞ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–æ–º–∏–ª–∫–∏ </strong> (—Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏)</summary>

<div style="background:#f8f9fa; padding:4px; text-align: justify; border-left:2px solid #3498db; margin:0px 0; line-height:1.5; font-size:0.8em;">

<p>–¢—É—Ç —Ä–æ–∑–≤‚Äô—è–∑—É—î—Ç—å—Å—è –∑–∞–¥–∞—á–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –µ–ª—ñ–ø—Ç–∏—á–Ω–æ—ó –æ—Ä–±—ñ—Ç–∏ –∑–∞ –≤—ñ–¥–æ–º–∏–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ N —É–ª–∞–º–∫—ñ–≤ –∞—Å—Ç–µ—Ä–æ—ó–¥–∞.  
–ö–ª—é—á–æ–≤–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –µ–ª—ñ–ø—Å–∞: <strong>—Å—É–º–∞ –≤—ñ–¥—Å—Ç–∞–Ω–µ–π –≤—ñ–¥ –±—É–¥—å-—è–∫–æ—ó —Ç–æ—á–∫–∏ –µ–ª—ñ–ø—Å–∞ –¥–æ –¥–≤–æ—Ö —Ñ–æ–∫—É—Å—ñ–≤ —î —Å—Ç–∞–ª–æ—é</strong> —ñ –ø–æ–∑–Ω–∞—á–∞—î—Ç—å—Å—è <strong>L</strong>.</p>

<p>–û–¥–∏–Ω —Ñ–æ–∫—É—Å –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ –≤ –ø–æ—á–∞—Ç–∫—É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç ‚Äî —Ü–µ –°–æ–Ω—Ü–µ:  
$$ F_1 = (0,0,0) $$  
–î—Ä—É–≥–∏–π —Ñ–æ–∫—É—Å —à—É–∫–∞—î–º–æ:  
$$ F_2 = (f_x, f_y, f_z) $$  
–ö—Ä—ñ–º —Ç–æ–≥–æ, –ø–ª–æ—â–∏–Ω–∞ –æ—Ä–±—ñ—Ç–∏ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤–µ—Ä–Ω—É—Ç–∞ –Ω–∞–≤–∫–æ–ª–æ –æ—Å—ñ $F_1F_2$ –Ω–∞ –∫—É—Ç $\varphi$.  
–û—Ç–∂–µ, –º–∞—î–º–æ <strong>—á–æ—Ç–∏—Ä–∏ –Ω–µ–≤—ñ–¥–æ–º—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</strong>: $f_x$, $f_y$, $f_z$, $\varphi$.</p>

<h3>–§—É–Ω–∫—Ü—ñ—è –ø–æ–º–∏–ª–∫–∏ (—Ç–µ, —â–æ –º—ñ–Ω—ñ–º—ñ–∑—É—î—Ç—å—Å—è –º–µ—Ç–æ–¥–æ–º –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤)</h3>

\[
\boxed{
S(f_x,f_y,f_z,\varphi)
= \sum_{i=1}^{N} \left[ d_i(f_x,f_y,f_z,\varphi) \right]^2
}
\]

–¥–µ $d_i$ ‚Äî –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –≤—ñ–¥ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂—É–≤–∞–Ω–æ—ó —Ç–æ—á–∫–∏ $P_i=(x_i,y_i,z_i)$ –¥–æ –µ–ª—ñ–ø—Ç–∏—á–Ω–æ—ó –∫—Ä–∏–≤–æ—ó.

<h3>–û–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å $d_i$</h3>

\[
d_i(f_x,f_y,f_z,\varphi)
= \min_{t\in [0,2\pi]}
\Bigl\|
P_i
- \Bigl( C + a\cos t\;\mathbf{e} + b\sin t\;\mathbf{e}^{\perp}(\varphi) \Bigr)
\Bigr\|
\]

<h3>–£ —Ü—ñ–π —Ñ–æ—Ä–º—É–ª—ñ:</h3>

<ul>
<li>$\mathbf{f} = (f_x, f_y, f_z)$ ‚Äî –≤–µ–∫—Ç–æ—Ä –≤—ñ–¥ $F_1$ –¥–æ $F_2$.<br><br></li>

<li>$c = \|\mathbf{f}\| = \sqrt{f_x^2 + f_y^2 + f_z^2}$ ‚Äî –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ —Ñ–æ–∫—É—Å–∞–º–∏.<br><br></li>

<li>$\mathbf{e} = \dfrac{\mathbf{f}}{c}$ ‚Äî <strong>–æ–¥–∏–Ω–∏—á–Ω–∏–π</strong> –≤–µ–∫—Ç–æ—Ä —É –Ω–∞–ø—Ä—è–º–∫—É –≤—ñ–¥ $F_1$ –¥–æ $F_2$ (–π–æ–≥–æ –¥–æ–≤–∂–∏–Ω–∞ —Ç–æ—á–Ω–æ –¥–æ—Ä—ñ–≤–Ω—é—î 1).<br><br></li>

<li>$C = \dfrac{\mathbf{f}}{2} = \dfrac{c}{2}\,\mathbf{e}$ ‚Äî —Ü–µ–Ω—Ç—Ä –µ–ª—ñ–ø—Å–∞ (—Å–µ—Ä–µ–¥–∏–Ω–∞ –≤—ñ–¥—Ä—ñ–∑–∫–∞ –º—ñ–∂ —Ñ–æ–∫—É—Å–∞–º–∏).<br><br></li>

<li>$\bar{L} = \dfrac{1}{N}\sum_{j=1}^{N} \Bigl( \|P_j\| + \|P_j - \mathbf{f}\| \Bigr)$ ‚Äî –Ω–∞–π–∫—Ä–∞—â–∞ –æ—Ü—ñ–Ω–∫–∞ —Å—Ç–∞–ª–æ—ó $L$ –¥–ª—è –ø–æ—Ç–æ—á–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å $f_x,f_y,f_z$.  
–†–∏—Å–æ—á–∫–∞ –∑–≤–µ—Ä—Ö—É –æ–∑–Ω–∞—á–∞—î ¬´—Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è¬ª.<br><br></li>

<li>$a = \dfrac{\bar{L}}{2}$ ‚Äî –ø—ñ–≤–≤–µ–ª–∏–∫–∞ –≤—ñ—Å—å –µ–ª—ñ–ø—Å–∞.<br><br></li>

<li>$b = \sqrt{a^2 - c^2}$ ‚Äî –ø—ñ–≤–º–∞–ª–∞ –≤—ñ—Å—å (—Ä–µ–∞–ª—å–Ω–∞ —Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ $a > c$).<br><br></li>

<li>$\mathbf{e}^{\perp}(\varphi)$ ‚Äî –æ–¥–∏–Ω–∏—á–Ω–∏–π –≤–µ–∫—Ç–æ—Ä, –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–∏–π –¥–æ $\mathbf{e}$, —ñ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π –Ω–∞ –∫—É—Ç $\varphi$ –Ω–∞–≤–∫–æ–ª–æ –æ—Å—ñ $\mathbf{e}$.</li>
</ul>

<h3>–Ø–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ–∫—Ç–æ—Ä $\mathbf{e}^{\perp}(\varphi)$</h3>

1. –ë–µ—Ä–µ–º–æ –¥–æ–≤—ñ–ª—å–Ω–∏–π –≤–µ–∫—Ç–æ—Ä $\mathbf{v}$, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ $(0,1,0)$ (—è–∫—â–æ –≤—ñ–Ω –º–∞–π–∂–µ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π $\mathbf{e}$, –±–µ—Ä–µ–º–æ $(1,0,0)$).<br>
2. –†–æ–±–∏–º–æ –π–æ–≥–æ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–∏–º:  
$\mathbf{u}_0 = \mathbf{v} - (\mathbf{v}\cdot\mathbf{e})\mathbf{e}$<br>
3. –ù–æ—Ä–º—É—î–º–æ: $\mathbf{u} = \dfrac{\mathbf{u}_0}{\|\mathbf{u}_0\|}$<br>
4. –î—Ä—É–≥–∏–π –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–∏–π –≤–µ–∫—Ç–æ—Ä: $\mathbf{w} = \mathbf{e} \times \mathbf{u}$<br>
5. –û—Å—Ç–∞—Ç–æ—á–Ω–æ:  
$$
\mathbf{e}^{\perp}(\varphi) = \mathbf{u}\cos\varphi + \mathbf{w}\sin\varphi
$$

–ê–±–æ –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ —á–µ—Ä–µ–∑ –º–∞—Ç—Ä–∏—Ü—é –ø–æ–≤–æ—Ä–æ—Ç—É –†–æ–¥—Ä—ñ–≥–µ—Å–∞ –Ω–∞–≤–∫–æ–ª–æ –æ—Å—ñ $\mathbf{e}=(e_x,e_y,e_z)$ –Ω–∞ –∫—É—Ç $\varphi$:

$$
K = \begin{pmatrix}
0 & -e_z & e_y \\
e_z & 0 & -e_x \\
-e_y & e_x & 0
\end{pmatrix},
\qquad$$
<br>
$$R = I + \sin\varphi\,K + (1-\cos\varphi)K^2,
\qquad$$ <br>

$$\mathbf{e}^{\perp}(\varphi) = R\mathbf{u}
$$

<h3>–©–æ –æ–∑–Ω–∞—á–∞—î $\min_{t}$ —ñ —è–∫ –π–æ–≥–æ –æ–±—á–∏—Å–ª—é–≤–∞—Ç–∏</h3>

–ü–∞—Ä–∞–º–µ—Ç—Ä $t$ ‚Äî —Ü–µ –∫—É—Ç, —è–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑—É—î –ø–æ–ª–æ–∂–µ–Ω–Ω—è —Ç–æ—á–∫–∏ –Ω–∞ –µ–ª—ñ–ø—Å—ñ (–≤—ñ–¥ 0 –¥–æ $2\pi$).  
–í–∏—Ä–∞–∑ —É –∫—Ä—É–≥–ª–∏—Ö –¥—É–∂–∫–∞—Ö ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ —Ç–æ—á–∫–∏ –Ω–∞ –µ–ª—ñ–ø—Å—ñ –ø—Ä–∏ –¥–∞–Ω–æ–º—É $t$.  
–¢—Ä–µ–±–∞ –∑–Ω–∞–π—Ç–∏ —Ç–∞–∫–µ $t$, –ø—Ä–∏ —è–∫–æ–º—É —Ü—è —Ç–æ—á–∫–∞ –Ω–∞–π–±–ª–∏–∂—á–∞ –¥–æ $P_i$.

–ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —ñ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ—á–Ω–∏–π —Å–ø–æ—Å—ñ–± ‚Äî –≤–∑—è—Ç–∏ –±–∞–≥–∞—Ç–æ –∑–Ω–∞—á–µ–Ω—å $t$ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 200‚Äì300 —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ –Ω–∞ $[0,2\pi]$) —ñ –æ–±—Ä–∞—Ç–∏ –Ω–∞–π–º–µ–Ω—à—É –≤—ñ–¥—Å—Ç–∞–Ω—å. –°–∞–º–µ —Ç–∞–∫ –∑—Ä–æ–±–ª–µ–Ω–æ –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä—ñ.

–¢–æ—á–Ω–µ –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è $t$ –≤–∏–º–∞–≥–∞—î —Ä–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—è —Ä—ñ–≤–Ω—è–Ω–Ω—è 4-–≥–æ —Å—Ç–µ–ø–µ–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ $i$ —ñ –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó, —Ç–æ–º—É –≤ –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö —ñ –±–∞–≥–∞—Ç—å–æ—Ö —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–∞—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –Ω–∞–±–ª–∏–∂–µ–Ω–Ω—è –∑ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü—ñ—î—é.

<h3>–ü—ñ–¥—Å—É–º–∫–æ–≤–∞ —Ñ–æ—Ä–º—É–ª–∞ </h3>

\[
\boxed{
\begin{aligned}
S(f_x,f_y,f_z,\varphi) 
&= \sum_{i=1}^{N} \min_{t\in[0,2\pi]}
   \Bigl\|
   P_i - \Bigl( C + a\cos t\;\mathbf{e} + b\sin t\;\mathbf{e}^{\perp}(\varphi) \Bigr)
   \Bigr\|^2
   \\[5pt]
&\text{–¥–µ –≤—Å—ñ –≤–µ–ª–∏—á–∏–Ω–∏ } C,\;a,\;b,\;\mathbf{e},\;\mathbf{e}^{\perp}(\varphi) 
\\[4pt]
&\text{ —è–≤–Ω–æ –≤–∏—Ä–∞–∂–µ–Ω—ñ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ } f_x,f_y,f_z,\varphi
\end{aligned}
}
\]

–°–∞–º–µ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é $S$ –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –º—ñ–Ω—ñ–º—ñ–∑—É–≤–∞—Ç–∏ —á–∏—Å–µ–ª—å–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞ –¥—Ä—É–≥—ñ–π –≤–∫–ª–∞–¥—Ü—ñ.  
–¶–µ –∫–ª–∞—Å–∏—á–Ω–∞ –Ω–µ–ª—ñ–Ω—ñ–π–Ω–∞ –∑–∞–¥–∞—á–∞ –º–µ—Ç–æ–¥—É –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ —ñ–∑ —á–æ—Ç–∏—Ä–º–∞ –Ω–µ–≤—ñ–¥–æ–º–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

</div>
</details>
		
		
        </div>

        <div class="control-group">
            <h4>–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –û—Ä–±—ñ—Ç–∏</h4>
            <div class="slider-wrapper"><label>F2 X: <span id="val-fx">5</span></label><input type="range" id="sl-fx" min="-20" max="20" step="0.1" oninput="Mod2.manualUpdate()"></div>
            <div class="slider-wrapper"><label>F2 Y (–í–∏—Å–æ—Ç–∞): <span id="val-fy">2</span></label><input type="range" id="sl-fy" min="-20" max="20" step="0.1" oninput="Mod2.manualUpdate()"></div>
            <div class="slider-wrapper"><label>F2 Z: <span id="val-fz">5</span></label><input type="range" id="sl-fz" min="-20" max="20" step="0.1" oninput="Mod2.manualUpdate()"></div>
            <div class="slider-wrapper"><label>–ù–∞—Ö–∏–ª –ø–ª–æ—â–∏–Ω–∏: <span id="val-rot">0</span>¬∞</label><input type="range" id="sl-rot" min="0" max="180" step="1" oninput="Mod2.manualUpdate()"></div>
            <br>
            <button onclick="Mod2.generateObservations()" class="secondary">‚òÑÔ∏è –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ —É–ª–∞–º–∫–∏</button>
            <button onclick="Mod2.optimize()" class="primary">üöÄ –°–ø—Ä–æ–±–∞ —á–∏—Å–µ–ª—å–Ω–æ–≥–æ —Ä–æ–∑–≤'—è–∑–∫—É</button>
        </div>
        <div class="error-display" id="t2-error">MSE: --</div>
    </div>
    <div class="right-panel">
        <div id="asteroid-container">
            <div id="asteroid-overlay">
                üü° –°–æ–Ω—Ü–µ (0,0,0)<br>‚ùå F2 (–®—É–∫–∞–Ω–∏–π —Ñ–æ–∫—É—Å)<br>‚ö™ –£–ª–∞–º–∫–∏ (–î–∞–Ω—ñ)<br>üîµ –û—Ä–±—ñ—Ç–∞ (–ú–æ–¥–µ–ª—å)
            </div>
        </div>
    </div>
</div>

<div id="tab3" class="tab-content">
    <div class="left-panel">
        <div class="story-box" style="background:#e8f6f3; border-left-color:#e74c3c;">
            <span style="display:block; font-weight:bold; margin-bottom:5px;">–ï–ø—ñ–¥–µ–º—ñ—è.</span>
            –û—Ç—Ä–∏–º–∞–Ω–æ –¥–∞–Ω—ñ –ø—Ä–æ –Ω–æ–≤—ñ –≤–∏–ø–∞–¥–∫–∏ —ñ–Ω—Ñ—ñ–∫—É–≤–∞–Ω–Ω—è. –©–æ–± —Å–ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞—Ç–∏ –ø—ñ–∫ –µ–ø—ñ–¥–µ–º—ñ—ó —Ç–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –ª—ñ–∫–∞—Ä–Ω—ñ, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∞–ø—Ä–æ–∫—Å–∏–º—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ—é –∫—Ä–∏–≤–æ—é (–ø–æ–ø—É–ª—è—Ä–Ω–∞ –º–æ–¥–µ–ª—å –≤ –±—ñ–æ–ª–æ–≥—ñ—ó —ñ –µ–∫–æ–Ω–æ–º—ñ—Ü—ñ).
        </div>
        <div class="math-box">
            $$ I(t) = \frac{L}{1 + e^{-k(t - t_0)}} $$
            <ul><li>$L$ - –º–µ–∂–∞ –Ω–∞—Å–∏—á–µ–Ω–Ω—è</li><li>$k$ - —à–≤–∏–¥–∫—ñ—Å—Ç—å</li><li>$t_0$ - –¥–µ–Ω—å –ø—ñ–∫—É</li></ul>
        </div>

        <div class="control-group">
            <h4>–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –ú–æ–¥–µ–ª—ñ</h4>
            <div class="slider-wrapper"><label>L (–Ñ–º–Ω—ñ—Å—Ç—å): <span id="val-L">1000</span></label><input type="range" id="sl-L" min="500" max="5000" step="10" oninput="Mod3.manualUpdate()"></div>
            <div class="slider-wrapper"><label>k (–®–≤–∏–¥–∫—ñ—Å—Ç—å): <span id="val-k">0.5</span></label><input type="range" id="sl-k" min="0.1" max="2.0" step="0.01" oninput="Mod3.manualUpdate()"></div>
            <div class="slider-wrapper"><label>t0 (–î–µ–Ω—å –ø—ñ–∫—É): <span id="val-x0">10</span></label><input type="range" id="sl-x0" min="0" max="30" step="0.1" oninput="Mod3.manualUpdate()"></div>
            
            <button onclick="Mod3.generateData()" class="secondary">‚ò£Ô∏è –ù–æ–≤–∏–π —Å–ø–∞–ª–∞—Ö (–ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏)</button>
            <button id="btn-opt-t3" onclick="Mod3.startOptimization()" class="primary">üß¨ –ü—ñ–¥—ñ–±—Ä–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</button>
        </div>
        <div class="error-display" id="t3-error">SSR: --</div>
    </div>
    <div class="right-panel">
        <div id="plot3"></div>
    </div>
</div>

<script>
    // --- MAIN APP CONTROLLER ---
    const app = {
        openTab: (id) => {
            document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            const btns = document.querySelectorAll('.tab-btn');
            if(id === 'tab1') btns[0].classList.add('active');
            if(id === 'tab2') { btns[1].classList.add('active'); setTimeout(() => Mod2.onResize(), 100); }
            if(id === 'tab3') { btns[2].classList.add('active'); Plotly.relayout('plot3', {autosize: true}); }
            window.dispatchEvent(new Event('resize'));
        }
    };

    // =========================================================================
    // MODULE 1: CALIBRATION SCRIPT (COMPLETELY REWRITTEN)
    // =========================================================================
   
   
   // =========================================================================
// MODULE 1: CALIBRATION (FIXED v3 - GD Plot & True Curve)
// =========================================================================
const Mod1 = {
    points: [],
    params: { p1: 0, p2: 0, p3: 0 },
    trueParams: {},
    isSolverRunning: false,
    showTrueCurve: false, // –ü—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ—Å—Ç–∏–Ω–∏

    init: () => {
        Mod1.onModelChange();
    },

    // --- MODEL FORMULAS ---
    getModelFunc: (modelName) => {
        if (modelName === 'linear') return (x, p) => p.p1 * x + p.p2;
        if (modelName === 'parabola') return (x, p) => p.p1 * x*x + p.p2 * x + p.p3;
        if (modelName === 'log') return (x, p) => p.p1 * Math.log(x) + p.p2;
        // p1=Amp, p2=Freq, p3=Decay
        if (modelName === 'damped') return (x, p) => p.p1 * Math.exp(-p.p3 * x) * Math.sin(p.p2 * x);
        return (x) => 0;
    },

    // --- UI EVENTS ---
    onModelChange: () => {
        const model = document.getElementById('t1-model').value;
        const s1 = document.getElementById('sl-p1');
        const s2 = document.getElementById('sl-p2');
        const s3 = document.getElementById('sl-p3');
        const p3Wrap = document.getElementById('wrap-p3');
        const mathBox = document.getElementById('t1-math');
        const btnSolve = document.getElementById('btn-t1-solve');

        // Reset UI
        p3Wrap.style.display = 'block';
        document.getElementById('gd-plot').style.display = 'none';
        Mod1.hideMessage();
        Mod1.isSolverRunning = false;
        Mod1.showTrueCurve = false; // Reset visuals

        if (model === 'linear') {
            Mod1.configSlider(s1, 'p1', 'a (–ù–∞—Ö–∏–ª)', -5, 5, 0.1, 1);
            Mod1.configSlider(s2, 'p2', 'b (–ó—Å—É–≤)', -5, 5, 0.1, 0);
            p3Wrap.style.display = 'none'; 
            mathBox.innerHTML = "$$ y = ax + b $$";
            btnSolve.innerText = "‚ö° –ó–Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–æ (–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞)";
        } else if (model === 'parabola') {
            Mod1.configSlider(s1, 'p1', 'a (–í–∏–≥–∏–Ω)', -2, 2, 0.05, 0.5);
            Mod1.configSlider(s2, 'p2', 'b (–ù–∞—Ö–∏–ª)', -5, 5, 0.1, 0);
            Mod1.configSlider(s3, 'p3', 'c (–ó—Å—É–≤)', -5, 5, 0.1, 0);
            mathBox.innerHTML = "$$ y = ax^2 + bx + c $$";
            btnSolve.innerText = "‚ö° –ó–Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–æ (–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞)";
        } else if (model === 'log') {
            Mod1.configSlider(s1, 'p1', 'a (–ú–Ω–æ–∂–Ω–∏–∫)', -5, 5, 0.1, 1);
            Mod1.configSlider(s2, 'p2', 'b (–ó—Å—É–≤)', -5, 5, 0.1, 0);
            p3Wrap.style.display = 'none';
            mathBox.innerHTML = "$$ y = a \\ln(x) + b $$";
            btnSolve.innerText = "‚ö° –ó–Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–æ (–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞)";
        } else if (model === 'damped') {
            Mod1.configSlider(s1, 'p1', 'A (–ê–º–ø–ª.)', 0, 8, 0.1, 3);
            Mod1.configSlider(s2, 'p2', 'œâ (–ß–∞—Å—Ç–æ—Ç–∞)', 0.5, 5, 0.1, 1);
            Mod1.configSlider(s3, 'p3', 'Œª (–ó–≥–∞—Å–∞–Ω.)', 0, 2, 0.01, 0.2);
            mathBox.innerHTML = "$$ y = A e^{-\\lambda x} \\sin(\\omega x) $$";
            btnSolve.innerText = "‚ö° –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –°–ø—É—Å–∫ (–ß–∏—Å–µ–ª—å–Ω–æ)";
        }

        if(window.MathJax) MathJax.typeset();
        Mod1.addRandom(); 
    },

    configSlider: (el, key, txt, min, max, step, def) => {
        el.min = min; el.max = max; el.step = step; el.value = def;
        document.getElementById('lbl-'+key).innerText = txt;
    },

    onSliderInput: () => {
        Mod1.params.p1 = parseFloat(document.getElementById('sl-p1').value);
        Mod1.params.p2 = parseFloat(document.getElementById('sl-p2').value);
        Mod1.params.p3 = parseFloat(document.getElementById('sl-p3').value);
        Mod1.renderPlot();
    },

    // --- DATA GENERATION ---
    addRandom: () => {
        const model = document.getElementById('t1-model').value;
        Mod1.points = [];
        Mod1.hideMessage();
        Mod1.showTrueCurve = false;
        
        // Generate "True" parameters for validation
        if (model === 'linear') Mod1.trueParams = { p1: (Math.random()-0.5)*3, p2: (Math.random()*4)-2, p3:0 };
       
		else if (model === 'parabola') {
            // –ì–µ–Ω–µ—Ä—É—î–º–æ —á–µ—Ä–µ–∑ –≤–µ—Ä—à–∏–Ω—É (vx, vy), —â–æ–± "–≥–æ—Ä–±" –±—É–≤ –ø–æ —Ü–µ–Ω—Ç—Ä—É
            const vx = 3 + Math.random() * 4;      // –í–µ—Ä—à–∏–Ω–∞ X –≤—ñ–¥ 3 –¥–æ 7 (—Ü–µ–Ω—Ç—Ä)
            const vy = (Math.random() - 0.5) * 4;  // –í–µ—Ä—à–∏–Ω–∞ Y –≤—ñ–¥ -2 –¥–æ 2
            const dir = Math.random() < 0.5 ? 1 : -1; 
            const a = dir * (0.05 + Math.random() * 0.1); // –ù–µ–≤–µ–ª–∏–∫–∏–π –≤–∏–≥–∏–Ω, —â–æ–± –Ω–µ —Å—Ç—Ä—ñ–ª—è–ª–æ –≤ –∫–æ—Å–º–æ—Å
            
            // –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑ –≤–µ—Ä—à–∏–Ω–Ω–æ—ó —Ñ–æ—Ä–º–∏ y=a(x-vx)^2+vy —É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É y=ax^2+bx+c
            Mod1.trueParams = { p1: a, p2: -2 * a * vx, p3: a * vx * vx + vy };
        }

	   else if (model === 'log') Mod1.trueParams = { p1: 1 + Math.random()*2, p2: (Math.random()*4)-2, p3:0 };
        else if (model === 'damped') Mod1.trueParams = { p1: 3+Math.random()*2, p2: 1+Math.random()*3, p3: 0.1+Math.random()*0.3 };

        const func = Mod1.getModelFunc(model);
        // Generate points x in [0.5, 9.5]
        for(let i=0; i<12; i++) {
            let x = 0.5 + Math.random() * 9.0;
            let yTrue = func(x, Mod1.trueParams);
            // Add noise
            let noise = (Math.random() - 0.5) * (model==='damped' ? 1.0 : 1.5);
            Mod1.points.push({ x: x, y: yTrue + noise });
        }
        Mod1.points.sort((a,b) => a.x - b.x);
        Mod1.onSliderInput(); 
    },

    // --- VISUALIZATION ---
    renderPlot: () => {
        const model = document.getElementById('t1-model').value;
        ['p1','p2','p3'].forEach(k => document.getElementById('val-'+k).innerText = Mod1.params[k].toFixed(3));

        const func = Mod1.getModelFunc(model);
        const mse = Mod1.calculateMSE(func, Mod1.params);
        document.getElementById('t1-mse').innerText = `MSE: ${mse.toFixed(4)}`;

        // 1. Current Model Curve
        const curveX = [], curveY = [];
        for(let x=0; x<=10; x+=0.1) { curveX.push(x); curveY.push(func(x, Mod1.params)); }

        // 2. True Curve (If needed)
        const trueX = [], trueY = [];
        if (Mod1.showTrueCurve) {
            for(let x=0; x<=10; x+=0.1) { trueX.push(x); trueY.push(func(x, Mod1.trueParams)); }
        }

        // 3. Squares (Residuals)
        const shapes = [];
        Mod1.points.forEach(p => {
            const yModel = func(p.x, Mod1.params);
            const diff = p.y - yModel;
            const size = Math.abs(diff); 
            
            if (size > 0.05 && size < 15) {
                shapes.push({
                    type: 'rect', xref: 'x', yref: 'y',
                    x0: p.x, x1: p.x + (diff > 0 ? size : size), // Square to right
                    y0: yModel, y1: p.y,
                    fillcolor: 'rgba(231, 76, 60, 0.3)', line: { width: 1, color: '#c0392b' }
                });
            }
        });

        // Traces
        const data = [];
        // Data Points
        data.push({ 
            x: Mod1.points.map(p => p.x), y: Mod1.points.map(p => p.y), 
            mode: 'markers', marker: { size: 10, color: '#2c3e50', line: {color:'white', width:1} }, name:'–î–∞–Ω—ñ' 
        });
        // Current Model
        data.push({ 
            x: curveX, y: curveY, mode: 'lines', line: { color: '#3498db', width: 3 }, name:'–ú–æ–¥–µ–ª—å' 
        });
        // True Model (Conditional)
        if (Mod1.showTrueCurve) {
            data.push({
                x: trueX, y: trueY, mode: 'lines', 
                line: { color: '#27ae60', width: 2, dash: 'dash' }, name:'–Ü—Å—Ç–∏–Ω–∞' 
            });
        }
        
        const layout = { 
            margin: {t:20, l:40, r:20, b:30}, 
            xaxis: {title: 'X', range: [0, 10], zeroline: false}, 
            yaxis: {title: 'Y', range: [-5, 5], scaleanchor: "x", scaleratio: 1, zeroline: false},
            shapes: shapes, showlegend: true, autosize: true,
            legend: {x: 1, y: 1, xanchor: 'right'}
        };
        
        Plotly.react('plot1', data, layout, {displayModeBar: false, responsive: true});
    },

    calculateMSE: (func, params) => {
        if (Mod1.points.length === 0) return 0;
        let sum = 0;
        Mod1.points.forEach(p => sum += (p.y - func(p.x, params))**2);
        return sum / Mod1.points.length;
    },

    // --- SOLVERS ---
    solve: () => {
        if(Mod1.isSolverRunning) return; 
        const model = document.getElementById('t1-model').value;
        Mod1.hideMessage();
        Mod1.showTrueCurve = false;

        if (model === 'linear') Mod1.solveLinear();
        else if (model === 'parabola') Mod1.solveParabola();
        else if (model === 'log') Mod1.solveLog();
        else if (model === 'damped') Mod1.optimizeNumerical();
    },

    applyParams: (p1, p2, p3) => {
        Mod1.params = { p1, p2, p3 };
        document.getElementById('sl-p1').value = p1;
        document.getElementById('sl-p2').value = p2;
        document.getElementById('sl-p3').value = p3;
        Mod1.renderPlot();
    },

    solveLinear: () => {
        let n = Mod1.points.length;
        let sx = 0, sy = 0, sxy = 0, sxx = 0;
        Mod1.points.forEach(p => { sx+=p.x; sy+=p.y; sxy+=p.x*p.y; sxx+=p.x*p.x; });
        let det = n*sxx - sx*sx;
        if(Math.abs(det) < 1e-9) return;
        let a = (n*sxy - sx*sy)/det;
        let b = (sxx*sy - sx*sxy)/det;
        Mod1.applyParams(a, b, 0);
        Mod1.showMessage("–¢–æ—á–Ω–∏–π —Ä–æ–∑–≤'—è–∑–æ–∫ –∑–Ω–∞–π–¥–µ–Ω–æ!", true);
    },

    solveParabola: () => {
        let n = Mod1.points.length;
        let sx=0, sx2=0, sx3=0, sx4=0, sy=0, sxy=0, sx2y=0;
        Mod1.points.forEach(p => {
            let x=p.x, y=p.y;
            sx+=x; sx2+=x*x; sx3+=x*x*x; sx4+=x*x*x*x;
            sy+=y; sxy+=x*y; sx2y+=x*x*y;
        });
        const M = [[sx4, sx3, sx2, sx2y], [sx3, sx2, sx,  sxy], [sx2, sx,  n,   sy]];
        const res = Mod1.gauss3(M);
        if(res) {
            Mod1.applyParams(res[0], res[1], res[2]);
            Mod1.showMessage("–¢–æ—á–Ω–∏–π —Ä–æ–∑–≤'—è–∑–æ–∫ –∑–Ω–∞–π–¥–µ–Ω–æ!", true);
        } else {
            Mod1.showMessage("–ü–æ–º–∏–ª–∫–∞ –º–∞—Ç—Ä–∏—Ü—ñ", false);
        }
    },

    solveLog: () => {
        let n = Mod1.points.length;
        let st=0, sy=0, sty=0, stt=0;
        Mod1.points.forEach(p => {
            if(p.x <= 0) return;
            let t = Math.log(p.x);
            st+=t; sy+=p.y; sty+=t*p.y; stt+=t*t;
        });
        let det = n*stt - st*st;
        if(Math.abs(det) < 1e-9) return;
        let a = (n*sty - st*sy)/det;
        let b = (stt*sy - st*sty)/det;
        Mod1.applyParams(a, b, 0);
        Mod1.showMessage("–¢–æ—á–Ω–∏–π —Ä–æ–∑–≤'—è–∑–æ–∫ –∑–Ω–∞–π–¥–µ–Ω–æ!", true);
    },

    gauss3: (Mat) => {
        let n = 3;
        for (let i=0; i<n; i++) {
            let pivot = Mat[i][i];
            if (Math.abs(pivot) < 1e-9) return null;
            for (let j=i+1; j<=n; j++) Mat[i][j] /= pivot;
            for (let k=0; k<n; k++) {
                if (k !== i) {
                    let factor = Mat[k][i];
                    for (let j=i+1; j<=n; j++) Mat[k][j] -= factor * Mat[i][j];
                }
            }
        }
        return [Mat[0][3], Mat[1][3], Mat[2][3]];
    },

    optimizeNumerical: () => {
        Mod1.isSolverRunning = true;
        const btn = document.getElementById('btn-t1-solve');
        const plotDiv = document.getElementById('gd-plot');
        
        plotDiv.style.display = 'block'; // Make visible FIRST
        btn.disabled = true; 
        btn.innerText = "‚è≥ –û–±—á–∏—Å–ª–µ–Ω–Ω—è...";

        const func = Mod1.getModelFunc('damped');
        let p = { ...Mod1.params };
        
        // Initialize Plotly Graph immediately with empty data
        Plotly.newPlot('gd-plot', [{y:[], type:'scatter', mode:'lines', line:{color:'#e74c3c'}}], 
            {
                margin:{t:20,l:30,r:10,b:20}, 
                height:150, 
                title: {text: '–î–∏–Ω–∞–º—ñ–∫–∞ –∑–º–µ–Ω—à–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ (MSE)', font:{size:10}},
                xaxis:{title:''}, yaxis:{title:''}
            }, 
            {displayModeBar:false}
        );

        let step = 0.5; 
        let iter = 0;
        const maxIter = 100;
        
        const timer = setInterval(() => {
            let currentErr = Mod1.calculateMSE(func, p);
            
            // Extend trace for animation
            Plotly.extendTraces('gd-plot', {y: [[currentErr]]}, [0]);

            let improved = false;
            ['p1', 'p2', 'p3'].forEach(k => {
                let bestVal = p[k];
                // Try +step
                p[k] += step;
                let e1 = Mod1.calculateMSE(func, p);
                
                // Try -step
                p[k] -= 2*step;
                let e2 = Mod1.calculateMSE(func, p);
                
                p[k] += step; // reset

                if (e1 < currentErr) { p[k] += step; currentErr = e1; improved = true; }
                else if (e2 < currentErr) { p[k] -= step; currentErr = e2; improved = true; }
            });

            if (!improved) step *= 0.8; 
            
            Mod1.applyParams(p.p1, p.p2, p.p3); // Update main plot live

            iter++;
            if (step < 0.02 || iter > maxIter) {
                clearInterval(timer);
                Mod1.isSolverRunning = false;
                btn.disabled = false; 
                btn.innerText = "‚ö° –ì—Ä–∞–¥—ñ—î–Ω—Ç–Ω–∏–π –°–ø—É—Å–∫";
                
                // Validate Solution against Truth
                const trueMSE = Mod1.calculateMSE(func, Mod1.trueParams);
                
                // If found error is > 20% worse than true error, assume local minimum
                if (currentErr > trueMSE * 1.2 && currentErr > 0.1) {
                     Mod1.showMessage(`‚ö†Ô∏è –õ–æ–∫–∞–ª—å–Ω–∏–π –º—ñ–Ω—ñ–º—É–º! (–ü–æ–º–∏–ª–∫–∞: ${currentErr.toFixed(2)} vs –Ü–¥–µ–∞–ª: ${trueMSE.toFixed(2)})`, false);
                     Mod1.showTrueCurve = true; // Enable true curve
                     Mod1.renderPlot(); // Re-render to show green line
                } else {
                     Mod1.showMessage("‚úÖ –ì–ª–æ–±–∞–ª—å–Ω–∏–π –º—ñ–Ω—ñ–º—É–º –∑–Ω–∞–π–¥–µ–Ω–æ!", true);
                }
            }
        }, 40);
    },

    showMessage: (msg, isSuccess) => {
        const el = document.getElementById('t1-msg-box');
        el.style.display = 'block';
        el.innerText = msg;
        el.style.backgroundColor = isSuccess ? '#d4efdf' : '#fcf3cf';
        el.style.color = isSuccess ? '#1e8449' : '#7f6000';
        el.style.border = isSuccess ? '1px solid #27ae60' : '1px solid #f1c40f';
    },

    hideMessage: () => {
        document.getElementById('t1-msg-box').style.display = 'none';
    }
};
    // =========================================================================
    // MODULE 2: ASTEROID SCRIPT (COPY FROM v3.0)
    // =========================================================================
    const Mod2 = {
        scene: null, camera: null, renderer: null, controls: null,
        trueOrbit: { f2: new THREE.Vector3(-8, 4, 6), len: 40, rot: 30 },
        debris: [], vizObjects: {},
        
        init: () => {
            const container = document.getElementById('asteroid-container');
            Mod2.scene = new THREE.Scene(); Mod2.scene.background = new THREE.Color(0x020205);
            Mod2.camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
            Mod2.camera.position.set(30, 40, 50);
            Mod2.renderer = new THREE.WebGLRenderer({ antialias: true });
            Mod2.renderer.setSize(container.clientWidth, container.clientHeight);
            Mod2.renderer.shadowMap.enabled = true; 
            container.appendChild(Mod2.renderer.domElement);
            Mod2.controls = new THREE.OrbitControls(Mod2.camera, Mod2.renderer.domElement); 
            Mod2.controls.enableDamping = true;
            
            const ambient = new THREE.AmbientLight(0x333333); Mod2.scene.add(ambient);
            const sunLight = new THREE.PointLight(0xffffbb, 2, 100); sunLight.position.set(0, 0, 0); sunLight.castShadow = true; Mod2.scene.add(sunLight);
            const grid = new THREE.GridHelper(60, 60, 0x333333, 0x111111); Mod2.scene.add(grid);
            const sun = new THREE.Mesh(new THREE.SphereGeometry(1.5, 32, 32), new THREE.MeshBasicMaterial({ color: 0xffdd00 })); Mod2.scene.add(sun);
            const glow = new THREE.Mesh(new THREE.SphereGeometry(1.8, 16, 16), new THREE.MeshBasicMaterial({color: 0xff9900, transparent:true, opacity:0.6})); Mod2.scene.add(glow);

            Mod2.initVizObjects(); Mod2.generateObservations(); Mod2.manualUpdate(); Mod2.animate();
        },
        initVizObjects: () => {
            Mod2.vizObjects.line = new THREE.LineLoop(new THREE.BufferGeometry(), new THREE.LineBasicMaterial({ color: 0x3498db, linewidth: 2 })); Mod2.scene.add(Mod2.vizObjects.line);
            const pts = [new THREE.Vector3(-1.5,0,0), new THREE.Vector3(1.5,0,0), new THREE.Vector3(0,-1.5,0), new THREE.Vector3(0,1.5,0), new THREE.Vector3(0,0,-1.5), new THREE.Vector3(0,0,1.5)];
            Mod2.vizObjects.f2 = new THREE.LineSegments(new THREE.BufferGeometry().setFromPoints(pts), new THREE.LineBasicMaterial({ color: 0xff0000 })); Mod2.scene.add(Mod2.vizObjects.f2);
            Mod2.vizObjects.residuals = new THREE.Group(); Mod2.scene.add(Mod2.vizObjects.residuals);
        },
        createAsteroidMesh: (pos) => {
            const group = new THREE.Group(); const mat = new THREE.MeshStandardMaterial({ color: 0xeeeeee, roughness: 0.9, flatShading: true });
            const core = new THREE.Mesh(new THREE.DodecahedronGeometry(0.6, 0), mat); core.scale.set(1+Math.random()*0.5, 1+Math.random()*0.5, 1+Math.random()*0.5); group.add(core);
            for(let i=0; i<2; i++){ const bump = new THREE.Mesh(new THREE.DodecahedronGeometry(0.4, 0), mat); bump.position.set((Math.random()-0.5), (Math.random()-0.5), (Math.random()-0.5)); group.add(bump); }
            group.position.copy(pos); group.rotation.set(Math.random()*3, Math.random()*3, 0); return group;
        },
      generateObservations: () => {
            Mod2.debris.forEach(d => Mod2.scene.remove(d)); Mod2.debris = [];
            
            // 1. –ì–µ–Ω–µ—Ä—É—î–º–æ F2 –ø–æ–¥–∞–ª—ñ (–∑–±—ñ–ª—å—à—É—î–º–æ –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–æ 35), —â–æ–± –µ–ª—ñ–ø—Å –±—É–≤ –≤–µ–ª–∏–∫–∏–º
            Mod2.trueOrbit.f2.set((Math.random()-0.5)*35, (Math.random()-0.5)*35, (Math.random()-0.5)*35); 
            Mod2.trueOrbit.rot = Math.random() * 180;

            // 2. –†–∞—Ö—É—î–º–æ –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ —Ñ–æ–∫—É—Å–∞–º–∏ (–°–æ–Ω—Ü–µ 0,0,0 —Ç–∞ F2)
            const dist = Mod2.trueOrbit.f2.length();

            // 3. –•–ò–¢–†–Ü–°–¢–¨: –†–æ–±–∏–º–æ –¥–æ–≤–∂–∏–Ω—É "—Å—Ç—Ä—É–Ω–∏" (len) –∑–∞–ª–µ–∂–Ω–æ—é –≤—ñ–¥ –≤—ñ–¥—Å—Ç–∞–Ω—ñ.
            // –ï–∫—Å—Ü–µ–Ω—Ç—Ä–∏—Å–∏—Ç–µ—Ç e = dist / len. 
            // –ú–Ω–æ–∂–Ω–∏–∫ 1.2 –≥–∞—Ä–∞–Ω—Ç—É—î e ‚âà 0.83 (–≤–∏—Ç—è–≥–Ω—É—Ç–∞ –∫–æ–º–µ—Ç–∞). 
            // –ß–∏–º –±–ª–∏–∂—á–µ –º–Ω–æ–∂–Ω–∏–∫ –¥–æ 1.0, —Ç–∏–º —Ç–æ–Ω—à–∞ –æ—Ä–±—ñ—Ç–∞.
            Mod2.trueOrbit.len = dist * (1.5 + Math.random() * 0.4); 

            // –ì–µ–Ω–µ—Ä—É—î–º–æ —Ç–æ—á–∫–∏
            const pts = Mod2.getEllipseCurvePoints(new THREE.Vector3(0,0,0), Mod2.trueOrbit.f2, Mod2.trueOrbit.len, Mod2.trueOrbit.rot, 128);
            
            // –î–∞–ª—ñ –∫–æ–¥ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω (–≥–µ–Ω–µ—Ä–∞—Ü—ñ—è —É–ª–∞–º–∫—ñ–≤)...
            for(let i=0; i<12; i++) {
                let idx = Math.floor(Math.random() * pts.length); let p = pts[idx].clone();
                p.x += (Math.random()-0.5)*1; p.y += (Math.random()-0.5)*1; p.z += (Math.random()-0.5)*1; // –¢—Ä–æ—Ö–∏ –∑–º–µ–Ω—à–∏–≤ —à—É–º, —â–æ–± —á—ñ—Ç–∫—ñ—à–µ –±–∞—á–∏—Ç–∏ –∫—Ä–∏–≤—É
                const ast = Mod2.createAsteroidMesh(p); ast.userData = { pos: p }; Mod2.scene.add(ast); Mod2.debris.push(ast);
            }
            Mod2.manualUpdate();
        },
        getEllipseCurvePoints: (f1, f2, len, rotDeg, steps=100) => {
            const axisX = new THREE.Vector3().subVectors(f2, f1); const cDist = axisX.length(); if(cDist < 0.001 || len <= cDist) return [];
            axisX.normalize(); let ref = new THREE.Vector3(0,1,0); if(Math.abs(axisX.y) > 0.9) ref.set(1,0,0);
            const normalBase = new THREE.Vector3().crossVectors(axisX, ref).normalize(); normalBase.applyAxisAngle(axisX, rotDeg * Math.PI / 180);
            const axisY = normalBase; const center = new THREE.Vector3().addVectors(f1,f2).multiplyScalar(0.5);
            const a = len / 2; const c = cDist / 2; const b = Math.sqrt(a*a - c*c); const points = [];
            for(let i=0; i<=steps; i++) {
                const t = (i/steps)*Math.PI*2; const v = center.clone().add(axisX.clone().multiplyScalar(a * Math.cos(t))).add(axisY.clone().multiplyScalar(b * Math.sin(t)));
                points.push(v);
            }
            return points;
        },
        manualUpdate: () => {
            const fx = parseFloat(document.getElementById('sl-fx').value); const fy = parseFloat(document.getElementById('sl-fy').value);
            const fz = parseFloat(document.getElementById('sl-fz').value); const rot = parseFloat(document.getElementById('sl-rot').value);
            document.getElementById('val-fx').innerText=fx; document.getElementById('val-fy').innerText=fy; document.getElementById('val-fz').innerText=fz; document.getElementById('val-rot').innerText=rot;
            const f2 = new THREE.Vector3(fx, fy, fz); const f1 = new THREE.Vector3(0,0,0);
            let sumDist = 0; Mod2.debris.forEach(d => sumDist += d.userData.pos.distanceTo(f1) + d.userData.pos.distanceTo(f2));
            const len = Mod2.debris.length ? sumDist / Mod2.debris.length : 40;
            const curvePoints = Mod2.getEllipseCurvePoints(f1, f2, len, rot, 128);
            if(curvePoints.length > 0) { Mod2.vizObjects.line.geometry.setFromPoints(curvePoints); Mod2.vizObjects.line.visible = true; } else { Mod2.vizObjects.line.visible = false; }
            Mod2.vizObjects.f2.position.copy(f2); Mod2.updateResiduals(f1, f2, len, rot);
        },
        updateResiduals: (f1, f2, len, rot) => {
            Mod2.vizObjects.residuals.clear(); const curveSamples = Mod2.getEllipseCurvePoints(f1, f2, len, rot, 200);
            if(curveSamples.length === 0) { document.getElementById('t2-error').innerText = "MSE: Invalid"; return; }
            let sse = 0;
            Mod2.debris.forEach(d => {
                const p = d.userData.pos; let minD = Infinity; let closest = null;
                for(let cp of curveSamples) { let dist = p.distanceToSquared(cp); if(dist < minD) { minD = dist; closest = cp; } }
                sse += minD; const lineGeo = new THREE.BufferGeometry().setFromPoints([p, closest]);
                const line = new THREE.Line(lineGeo, new THREE.LineBasicMaterial({ color: 0xaaaaaa, transparent: true, opacity: 0.4 })); Mod2.vizObjects.residuals.add(line);
            });
            document.getElementById('t2-error').innerText = `MSE: ${(sse/Mod2.debris.length).toFixed(2)}`;
        },
        optimize: () => {
            let x = parseFloat(document.getElementById('sl-fx').value); let y = parseFloat(document.getElementById('sl-fy').value);
            let z = parseFloat(document.getElementById('sl-fz').value); let rot = parseFloat(document.getElementById('sl-rot').value);
            const btn = document.querySelector('#tab2 .primary'); btn.innerText = "‚è≥ –û–±—á–∏—Å–ª–µ–Ω–Ω—è..."; btn.disabled = true;
            const f1 = new THREE.Vector3(0,0,0);
            const getCost = (tx, ty, tz, tr) => {
                let tf2 = new THREE.Vector3(tx, ty, tz); let sum = 0; Mod2.debris.forEach(d=>sum+=d.userData.pos.distanceTo(f1)+d.userData.pos.distanceTo(tf2));
                let tLen = sum/Mod2.debris.length; let curve = Mod2.getEllipseCurvePoints(f1, tf2, tLen, tr, 60); if(curve.length===0) return 1e9;
                let err = 0; for(let d of Mod2.debris) { let minD = Infinity; for(let c of curve) if(d.userData.pos.distanceToSquared(c)<minD) minD=d.userData.pos.distanceToSquared(c); err+=minD; } return err;
            };
            let step = 2.0; let currentCost = getCost(x, y, z, rot); let iter = 0;
            const timer = setInterval(() => {
                let improved = false;
                [[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,5]].forEach(dir => {
                    [1, -1].forEach(sign => {
                        let nx=x+dir[0]*step*sign; let ny=y+dir[1]*step*sign; let nz=z+dir[2]*step*sign; let nr=rot+dir[3]*step*sign;
                        let c = getCost(nx, ny, nz, nr); if(c < currentCost) { x=nx; y=ny; z=nz; rot=nr; currentCost=c; improved=true; }
                    });
                });
                if(!improved) step *= 0.8;
                document.getElementById('sl-fx').value = x; document.getElementById('sl-fy').value = y; document.getElementById('sl-fz').value = z; document.getElementById('sl-rot').value = rot;
                Mod2.manualUpdate(); iter++;
                if(step < 0.05 || iter > 50) { clearInterval(timer); btn.innerText = "üöÄ –ó–Ω–∞–π—Ç–∏ –û—Ä–±—ñ—Ç—É (AI Optimization)"; btn.disabled = false; }
            }, 30);
        },
        animate: () => { requestAnimationFrame(Mod2.animate); Mod2.controls.update(); Mod2.debris.forEach(d => { d.rotation.x += 0.01; d.rotation.y += 0.01; }); Mod2.renderer.render(Mod2.scene, Mod2.camera); },
        onResize: () => { const c=document.getElementById('asteroid-container'); if(c&&Mod2.camera){ Mod2.camera.aspect=c.clientWidth/c.clientHeight; Mod2.camera.updateProjectionMatrix(); Mod2.renderer.setSize(c.clientWidth,c.clientHeight); } }
    };

    // =========================================================================
    // MODULE 3: PANDEMIC SCRIPT (COPY FROM v3.0)
    // =========================================================================
    const Mod3 = {
        data: [], state: {L:1000,k:0.5,x0:10},
        init: () => { Mod3.generateData(); },
        generateData: () => {
            Mod3.data = []; const trueL = 1000 + Math.random()*3000; const trueK = 0.15 + Math.random()*0.5; const trueX0 = 8 + Math.random()*12;
            for(let t=0; t<=25; t+=2) { let val = trueL / (1 + Math.exp(-trueK*(t - trueX0))); val += (Math.random()-0.5) * (trueL * 0.1); if(val<0) val=0; Mod3.data.push({d:t, c:val}); }
            Mod3.manualUpdate();
        },
        logistic: (x,L,k,x0) => L/(1+Math.exp(-k*(x-x0))),
        getSSR: (L,k,x0) => Mod3.data.reduce((acc,p)=>acc+(p.c-Mod3.logistic(p.d,L,k,x0))**2,0),
        manualUpdate: () => {
            Mod3.state.L=parseFloat(document.getElementById('sl-L').value); Mod3.state.k=parseFloat(document.getElementById('sl-k').value); Mod3.state.x0=parseFloat(document.getElementById('sl-x0').value);
            document.getElementById('val-L').innerText=Mod3.state.L.toFixed(0); document.getElementById('val-k').innerText=Mod3.state.k.toFixed(2); document.getElementById('val-x0').innerText=Mod3.state.x0.toFixed(1);
            document.getElementById('t3-error').innerText=`SSR: ${Mod3.getSSR(Mod3.state.L,Mod3.state.k,Mod3.state.x0).toFixed(0)}`;
            Mod3.draw();
        },
        startOptimization: () => {
            const btn=document.getElementById('btn-opt-t3'); btn.disabled=true; btn.innerText="‚è≥...";
            let {L,k,x0}=Mod3.state; let best=Mod3.getSSR(L,k,x0); let s={L:200,k:0.1,x0:2.0};
            const iv=setInterval(()=>{
                let ch=false;
                [[s.L,0,0],[0,s.k,0],[0,0,s.x0]].forEach(step => {
                    let nL=L+step[0], nK=k+step[1], nX=x0+step[2]; let e = Mod3.getSSR(nL,nK,nX);
                    if(e<best) { L=nL; k=nK; x0=nX; best=e; ch=true; } else { nL=L-step[0]; nK=k-step[1]; nX=x0-step[2]; e = Mod3.getSSR(nL,nK,nX); if(e<best) { L=nL; k=nK; x0=nX; best=e; ch=true; } }
                });
                if(!ch){s.L*=0.9;s.k*=0.9;s.x0*=0.9;}
                document.getElementById('sl-L').value=L; document.getElementById('sl-k').value=k; document.getElementById('sl-x0').value=x0; Mod3.manualUpdate();
                if(s.L<1 && s.k<0.001){clearInterval(iv);btn.disabled=false;btn.innerText="üß¨ –ü—ñ–¥—ñ–±—Ä–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏";}
            },30);
        },
        draw: () => {
            const xv=[],yv=[]; for(let x=0;x<=50;x+=0.5){xv.push(x);yv.push(Mod3.logistic(x,Mod3.state.L,Mod3.state.k,Mod3.state.x0));}
            Plotly.react('plot3',[{x:Mod3.data.map(p=>p.d),y:Mod3.data.map(p=>p.c),mode:'markers',name:'–í–∏–ø–∞–¥–∫–∏',marker:{color:'#c0392b',size:12}},{x:xv,y:yv,mode:'lines',name:'–ê–ø—Ä–æ–∫—Å–∏–º–∞—Ü—ñ—è',line:{color:'#27ae60',width:4}}],{margin:{t:20,l:40,r:20,b:30},xaxis:{title:'–î–µ–Ω—å'},yaxis:{title:'–Ü–Ω—Ñ—ñ–∫–æ–≤–∞–Ω—ñ'}},{displayModeBar:false});
        }
    };

    // --- INIT ---
    window.onload = () => { Mod1.init(); Mod2.init(); Mod3.init(); };
    window.onresize = () => { Mod2.onResize(); window.dispatchEvent(new Event('resize')); };
</script>
</body>
</html>