<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title> —Å–∏–º—É–ª—è—Ç–æ—Ä SVD –∑ Co-citation</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/numeric/1.2.6/numeric.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background-color: #f4f4f9;
    }
    h1, h3 {
      color: #333;
    }
    table {
      border-collapse: collapse;
      margin-bottom: 1rem;
      display: inline-block;
      margin-right: 2rem;
      vertical-align: top;
      background-color: white;
    }
    td, th {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: center;
      min-width: 40px;
    }
    input[type="number"] {
      width: 60px;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .highlight {
      background-color: #ffdddd;
      color: red;
      font-weight: bold;
    }
    .increase {
      background-color: #ddffdd;
      color: green;
      font-weight: bold;
    }
    canvas {
      border: 1px solid #ccc;
      margin-top: 1rem;
      background-color: white;
    }
    details {
      margin-top: 1rem;
      background: #eef;
      padding: 1rem;
      border-radius: 8px;
    }
    details details { /* Style for nested spoilers */
        background: #f8f8ff;
        margin-left: 1rem;
        border-left: 3px solid #007bff;
    }
    .controls, .results-container {
      background-color: #ffffff;
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    button {
      padding: 8px 15px;
      border: none;
      background-color: #007bff;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 5px;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h3> —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –º–∞—Ç—Ä–∏—Ü—ñ —Å—É–º—ñ–∂–Ω–æ—Å—Ç—ñ –¥–≤–æ–¥–æ–ª—å–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ (SVD)</h3>

  <div class="controls">
    <label>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ:
      <select id="userCount">
        <option>2</option><option>3</option><option>4</option><option selected>5</option><option>6</option>
      </select>
    </label>
    <label>–ö–∞–Ω–∞–ª–∏:
      <select id="channelCount">
        <option>2</option><option selected>3</option><option>4</option><option>5</option>
      </select>
    </label>
    <label>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ (k):
      <input type="number" id="latentFactors" min="1" value="2" style="width: 50px;">
    </label>
    <br><br>
    <button onclick="generateMatrix()">–û–Ω–æ–≤–∏—Ç–∏ –º–∞—Ç—Ä–∏—Ü—é</button>
    <button onclick="randomizeMatrix()">–ó–∞–ø–æ–≤–Ω–∏—Ç–∏ –≤–∏–ø–∞–¥–∫–æ–≤–æ</button>
    <br><br>
    <label><input type="checkbox" id="binaryMode"  onchange="generateMatrix()"> –ë—ñ–Ω–∞—Ä–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è (–ª–∏—à–µ 0 –∞–±–æ 1)</label>
    <br><br>
    <label>–ü–æ—Ä—ñ–≥ –¥–ª—è –Ω–æ–≤–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π: <span id="threshVal">0.8</span></label>
    <input type="range" id="threshold" min="0.1" max="1.0" step="0.05" value="0.8" style="width: 200px; vertical-align: middle;">
  </div>

  <div id="matrix-container"></div>
  <button onclick="factorize()">–§–∞–∫—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏ –º–∞—Ç—Ä–∏—Ü—é</button>

  <div class="results-container">
    <h3>–î–≤–æ–¥–æ–ª—å–Ω–∏–π –≥—Ä–∞—Ñ (–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ-–ö–∞–Ω–∞–ª–∏)</h3>
    <canvas id="graph" width="600" height="300"></canvas>
    <div id="results"></div>
    <hr>
    <h3>–ì—Ä–∞—Ñ Co-citation –¥–ª—è –ö–∞–Ω–∞–ª—ñ–≤ (B·µÄ ¬∑ B)</h3>
    <canvas id="coCitationGraph" width="400" height="400"></canvas>
    <div id="coCitationResults"></div>
  </div>

  <details>
    <div class="container">
        <h1>Low-rank SVD, –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏ —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</h1>

        <p>–¶–µ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –ø–æ—è—Å–Ω—é—î, —è–∫ –∑ —Ç—Ä—å–æ—Ö –º–∞—Ç—Ä–∏—Ü—å —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–æ–∑–∫–ª–∞–¥—É (SVD, Singular Value Decomposition) <code>U</code>, <code>Œ£</code>, <code>V</code>, –∑–±–∏—Ä–∞—î—Ç—å—Å—è –Ω–∞–±–ª–∏–∂–µ–Ω–∞ –≤–∏—Ö—ñ–¥–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è, —ñ –∑–≤—ñ–¥–∫–∏ –±–µ—Ä–µ—Ç—å—Å—è "–º–∞–≥—ñ—è" —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π–Ω–∏—Ö —Å–∏—Å—Ç–µ–º.</p>

        <hr>

        <h2>–Ø–∫ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—Ç—Ä–∏—Ü—é?</h2>
        <p>
            –í—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è (–∞–±–æ –∞–ø—Ä–æ–∫—Å–∏–º–∞—Ü—ñ—è) –≤–∏—Ö—ñ–¥–Ω–æ—ó –º–∞—Ç—Ä–∏—Ü—ñ <code>B</code> –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–Ω—è —Ç—Ä—å–æ—Ö –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –º–∞—Ç—Ä–∏—Ü—å, –∞–ª–µ –≤ —Å–∫–æ—Ä–æ—á–µ–Ω–æ–º—É (—É—Ä—ñ–∑–∞–Ω–æ–º—É) –≤–∏–≥–ª—è–¥—ñ:
        </p>
        <p style="text-align: center; font-size: 1.2em;">
            <code>B<sub>–Ω–∞–±–ª–∏–∂–µ–Ω–∞</sub> ‚âà U<sub>k</sub> ¬∑ Œ£<sub>k</sub> ¬∑ V<sub>k</sub><sup>T</sup></code>
        </p>
        <p>–î–µ:</p>
        <ul>
            <li><strong><code>U<sub>k</sub></code></strong> ‚Äî —Ü–µ –º–∞—Ç—Ä–∏—Ü—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∞–ª–µ –º–∏ –±–µ—Ä–µ–º–æ –Ω–µ –≤—Å—ñ —ó—ó —Å—Ç–æ–≤–ø—Ü—ñ, –∞ –ª–∏—à–µ –ø–µ—Ä—à—ñ <strong>k</strong> (–¥–µ <code>k</code> ‚Äî —Ü–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä—ñ–≤, —è–∫—É –≤–∏ –∑–∞–¥–∞–ª–∏).</li>
            <li><strong><code>Œ£<sub>k</sub></code> (–°–∏–≥–º–∞)</strong> ‚Äî —Ü–µ –¥—ñ–∞–≥–æ–Ω–∞–ª—å–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –≤–∞–≥, –¥–µ –º–∏ —Ç–∞–∫–æ–∂ –±–µ—Ä–µ–º–æ –ª–∏—à–µ –ø–µ—Ä—à—ñ, –Ω–∞–π–±—ñ–ª—å—à—ñ <strong>k</strong> –∑–Ω–∞—á–µ–Ω—å. –í–æ–Ω–∞ –≤–∏–≥–ª—è–¥–∞—î —è–∫ –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è —Ä–æ–∑–º—ñ—Ä–æ–º <code>k x k</code>.</li>
            <li><strong><code>V<sub>k</sub><sup>T</sup></code></strong> ‚Äî —Ü–µ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–æ–≤–∞–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –∫–∞–Ω–∞–ª—ñ–≤, –¥–µ –º–∏, –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –±–µ—Ä–µ–º–æ –ª–∏—à–µ –ø–µ—Ä—à—ñ <strong>k</strong> —Ä—è–¥–∫—ñ–≤.</li>
        </ul>
        <p>
            –ü–æ —Å—É—Ç—ñ, –º–∏ —Å–≤—ñ–¥–æ–º–æ <strong>–≤—ñ–¥–∫–∏–¥–∞—î–º–æ –º–µ–Ω—à –∑–Ω–∞—á—É—â—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é</strong> (–º–µ–Ω—à—ñ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —ó–º –≤–µ–∫—Ç–æ—Ä–∏), —â–æ–± —É–∑–∞–≥–∞–ª—å–Ω–∏—Ç–∏ –¥–∞–Ω—ñ. –Ø–∫–±–∏ –º–∏ –≤–∑—è–ª–∏ –≤—Å—ñ —Ñ–∞–∫—Ç–æ—Ä–∏ (<code>k</code> = –º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ –º–æ–∂–ª–∏–≤–µ), —Ç–æ –æ—Ç—Ä–∏–º–∞–ª–∏ –± —Ç–æ—á–Ω—É –∫–æ–ø—ñ—é –≤–∏—Ö—ñ–¥–Ω–æ—ó –º–∞—Ç—Ä–∏—Ü—ñ (<code>B = U ¬∑ Œ£ ¬∑ V<sup>T</sup></code>), –∞–ª–µ —Ü–µ –Ω–µ –º–∞–ª–æ –± —Å–µ–Ω—Å—É –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π.
        </p>

        <hr>

        <h2>–ß–æ–º—É —Ü–µ –ø—Ä–∞—Ü—é—î?</h2>
        <p>
            –£—è–≤—ñ—Ç—å, —â–æ "–ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏" ‚Äî —Ü–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞, –∞ <strong>—Ç–µ–º–∏, –∂–∞–Ω—Ä–∏, —Ü—ñ–ª—å–æ–≤—ñ –∞—É–¥–∏—Ç–æ—Ä—ñ—ó</strong>, —á–∏ —â–æ—Å—å –≤–∑–∞–≥–∞–ª—ñ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–µ (–Ω–∞ –∫—à–∞–ª—Ç –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ "—à–æ—É –≤–∏—Ö–æ–¥–∏—Ç—å —É –Ω–µ–¥—ñ–ª—é –∑—Ä–∞–Ω–∫—É"), —è–∫—ñ SVD –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (!) –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —É –¥–∞–Ω–∏—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
        </p>
        <ul>
            <li><strong>–§–∞–∫—Ç–æ—Ä 1:</strong> "–ù–∞—É–∫–æ–≤–∞ —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞"</li>
            <li><strong>–§–∞–∫—Ç–æ—Ä 2:</strong> "–ö–∞–Ω–∞–ª –¥–ª—è –ø—ñ–¥–ª—ñ—Ç–∫—ñ–≤"</li>
            <li><strong>–§–∞–∫—Ç–æ—Ä 3:</strong> "–ê–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ –ø—ñ–¥–∫–∞—Å—Ç–∏"</li>
        </ul>
        <p>–¢–æ–¥—ñ –º–∞—Ç—Ä–∏—Ü—ñ <code>U</code> —Ç–∞ <code>V</code> –ø–æ–∫–∞–∑—É—é—Ç—å "–ø—Ä–∏—á–µ—Ç–Ω—ñ—Å—Ç—å" –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —ñ –∫–∞–Ω–∞–ª—ñ–≤ –¥–æ —Ü–∏—Ö —Ç–µ–º:</p>
        <ol>
            <li><strong>–ú–∞—Ç—Ä–∏—Ü—è <code>U</code> (–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ ‚Üí –§–∞–∫—Ç–æ—Ä–∏):</strong>
                –†—è–¥–æ–∫ –¥–ª—è "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ 5" –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —è–∫ <code>[0.9, 0.1, -0.2]</code>. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤—ñ–Ω <strong>–¥—É–∂–µ –ª—é–±–∏—Ç—å</strong> –Ω–∞—É–∫–æ–≤—É —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫—É, <strong>–≤–∂–µ –¥–∞–≤–Ω–æ </strong> –Ω–µ –ø—ñ–¥–ª—ñ—Ç–æ–∫ —ñ, –º–æ–∂–ª–∏–≤–æ, <strong>–Ω–µ –ª—é–±–∏—Ç—å</strong> —Ñ–æ—Ä–º–∞—Ç –ø—ñ–¥–∫–∞—Å—Ç—ñ–≤.
            </li>
            <li><strong>–ú–∞—Ç—Ä–∏—Ü—è <code>V</code> (–ö–∞–Ω–∞–ª–∏ ‚Üí –§–∞–∫—Ç–æ—Ä–∏):</strong>
                –í–µ–∫—Ç–æ—Ä –¥–ª—è "–ö–∞–Ω–∞–ª—É 1" –º–æ–∂–µ –±—É—Ç–∏ <code>[0.8, 0.4, -1]</code>. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∫–∞–Ω–∞–ª –ø–µ—Ä–µ–≤–∞–∂–Ω–æ –ø—Ä–æ –Ω–∞—É–∫–æ–≤—É —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫—É, —á–∞—Å—Ç–∫–æ–≤–æ –æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ –º–æ–ª–æ–¥—å —ñ –ø—ñ–¥–ª—ñ—Ç–∫—ñ–≤, —ñ —Ç–æ—á–Ω–æ –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏—Ö —Ä–æ–∑–º–æ–≤.
            </li>
        </ol>
        <p>
            –ö–æ–ª–∏ –º–∏ –ø–µ—Ä–µ–º–Ω–æ–∂—É—î–º–æ <code>U ¬∑ Œ£ ¬∑ V<sup>T</sup></code>, –º–∏, –ø–æ —Å—É—Ç—ñ, –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø–∞—Ä–∏ "(–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á, –ö–∞–Ω–∞–ª)" –æ–±—á–∏—Å–ª—é—î–º–æ –ø—Ä–æ–≥–Ω–æ–∑ —Ä–µ–π—Ç–∏–Ω–≥—É –∑–∞ —Ç–∞–∫–∏–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–º:<br>
            <em>(–°—Ö–∏–ª—å–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ "–§–∞–∫–æ—Ç—Ä–∞") √ó (–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å "–§–∞–∫—Ç–æ—Ä–∞") √ó (–ü—Ä–∏–Ω–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –∫–∞–Ω–∞–ª—É –¥–æ "–§–∞–∫—Ç–æ—Ä–∞")</em>
        </p>
        <p>–°—É–º–∞ —Ü–∏—Ö –¥–æ–±—É—Ç–∫—ñ–≤ –ø–æ –≤—Å—ñ–º <code>k</code> —Ñ–∞–∫—Ç–æ—Ä–∞–º —ñ –¥–∞—î –Ω–∞–º –Ω–∞–±–ª–∏–∂–µ–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è <strong>—ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ–≥–æ</strong> —Ä–µ–π—Ç–∏–Ω–≥—É –≤ —Ä–µ–∑—É–ª—å—Ç—É—é—á—ñ–π –º–∞—Ç—Ä–∏—Ü—ñ.</p>

        <hr>

        <h2>–ó–≤—ñ–¥–∫–∏ –±–µ—Ä—É—Ç—å—Å—è "–Ω–æ–≤—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó"?</h2>
        <p>–ù–æ–≤—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó ‚Äî —Ü–µ –Ω–∞–π—Ü—ñ–∫–∞–≤—ñ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, —ñ –≤–∏–Ω–∏–∫–∞—é—Ç—å –≤–æ–Ω–∏ –∑–∞–≤–¥—è–∫–∏ <strong>—É–∑–∞–≥–∞–ª—å–Ω–µ–Ω–Ω—é</strong>.</p>
        <p>–†–æ–∑–≥–ª—è–Ω–µ–º–æ –ø—Ä–∏–∫–ª–∞–¥:</p>
        <ul>
            <li><strong>–î–∞–Ω–æ:</strong> –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ê –¥–∏–≤–∏–≤—Å—è –∫–∞–Ω–∞–ª–∏ "Alpha Centauri" —Ç–∞ "Universe Today" (–æ–±–∏–¥–≤–∞ –ø—Ä–æ –∫–æ—Å–º–æ—Å), –∞–ª–µ –Ω—ñ–∫–æ–ª–∏ –Ω–µ —á—É–≤ –ø—Ä–æ –∫–∞–Ω–∞–ª "Nauka 2.0". –í—Ö—ñ–¥–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –¥–ª—è –ø–∞—Ä–∏ (–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ê, "Nauka 2.0") –º—ñ—Å—Ç–∏—Ç—å <strong>0</strong>.</li>
            <li><strong>–©–æ —Ä–æ–±–∏—Ç—å SVD:</strong> –ê–Ω–∞–ª—ñ–∑—É—é—á–∏ –≤–ø–æ–¥–æ–±–∞–Ω–Ω—è, SVD –≤–∏—è–≤–ª—è—î –ø–æ—Ç—É–∂–Ω–∏–π –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π —Ñ–∞–∫—Ç–æ—Ä (–Ω–∞–∑–≤—ñ–º–æ –π–æ–≥–æ "–∫–æ—Å–º–æ—Å/–Ω–∞—É–∫–∞"). –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ê —Ç–∞ –≤—Å—ñ —Ç—Ä–∏ –∫–∞–Ω–∞–ª–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –≤–∏—Å–æ–∫—ñ –±–∞–ª–∏ –∑–∞ —Ü–∏–º —Ñ–∞–∫—Ç–æ—Ä–æ–º.</li>
            <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ö–æ–ª–∏ –º–∞—Ç—Ä–∏—Ü—è –≤—ñ–¥–Ω–æ–≤–ª—é—î—Ç—å—Å—è, –≤–∏—Å–æ–∫–∞ —Å—Ö–∏–ª—å–Ω—ñ—Å—Ç—å –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ê –¥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ "–∫–æ—Å–º–æ—Å" –º–Ω–æ–∂–∏—Ç—å—Å—è –Ω–∞ –≤–∏—Å–æ–∫—É –ø—Ä–∏–Ω–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –∫–∞–Ω–∞–ª—É "Nauka 2.0" –¥–æ —Ü—å–æ–≥–æ –∂ —Ñ–∞–∫—Ç–æ—Ä–∞. –£ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –¥–ª—è —Ü—ñ—î—ó –∫–æ–º—ñ—Ä–∫–∏ –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è <strong>–≤–∏—Å–æ–∫–∏–π –ø—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</strong> (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 0.85), —Ö–æ—á–∞ –≤ –æ—Ä–∏–≥—ñ–Ω–∞–ª—ñ –±—É–≤ 0.</li>
        </ul>
        <p>–¶–µ —ñ —î <strong>–Ω–æ–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è</strong>. –°–∏—Å—Ç–µ–º–∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–Ω–∞–π—à–ª–∞ —Å—Ö–æ–∂—ñ –∫–∞–Ω–∞–ª–∏, –≤–æ–Ω–∞ –∑—Ä–æ–∑—É–º—ñ–ª–∞ <em>–∫–æ–Ω—Ü–µ–ø—Ü—ñ—é</em> ("–ª—é–¥–∏–Ω–∞ –ª—é–±–∏—Ç—å –Ω–∞—É–∫—É –ø—Ä–æ –∫–æ—Å–º–æ—Å") —ñ –Ω–∞ —ó—ó –æ—Å–Ω–æ–≤—ñ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞–ª–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç.</p>
        
        <hr>

        <h2>–î–æ–¥–∞—Ç–∫–æ–≤—ñ –≤–∞–∂–ª–∏–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó</h2>

        <h3>1. –ü—Ä–∏—Ö–æ–≤–∞–Ω—ñ —Ñ–∞–∫—Ç–æ—Ä–∏ SVD ‚Äî –Ω–µ –∑–∞–≤–∂–¥–∏ –æ—á–µ–≤–∏–¥–Ω—ñ</h3>
        <p>SVD –≤–∏—è–≤–ª—è—î –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –∑–∞–∫–æ–Ω–æ–º—ñ—Ä–Ω–æ—Å—Ç—ñ, —è–∫—ñ –Ω–µ –∑–∞–≤–∂–¥–∏ –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏:</p>
        <ul>
            <li><strong>–ó—Ä–æ–∑—É–º—ñ–ª–∏–º–∏:</strong> —Ç–µ–º–∞—Ç–∏—á–Ω—ñ –∫–ª–∞—Å—Ç–µ—Ä–∏ (–Ω–∞—É–∫–∞, —Å–ø–æ—Ä—Ç, –º—É–∑–∏–∫–∞).</li>
            <li><strong>–ß–∞—Å—Ç–∫–æ–≤–æ –∑—Ä–æ–∑—É–º—ñ–ª–∏–º–∏:</strong> –¥–µ–º–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –≥—Ä—É–ø–∏ (–≤—ñ–∫, –≥–µ–æ–≥—Ä–∞—Ñ—ñ—è), —á–∞—Å–æ–≤—ñ –ø–∞—Ç–µ—Ä–Ω–∏.</li>
            <li><strong>–ù–µ–∑—Ä–æ–∑—É–º—ñ–ª–∏–º–∏:</strong> —Å–∫–ª–∞–¥–Ω—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó —Ä—ñ–∑–Ω–∏—Ö –æ–∑–Ω–∞–∫, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏ –¥–∞–Ω–∏—Ö –∞–±–æ –ø—Ä–æ—Å—Ç–æ —à—É–º.</li>
        </ul>
        <p><strong>–ü—Ä–∏–∫–ª–∞–¥:</strong> –û–¥–∏–Ω —Ñ–∞–∫—Ç–æ—Ä –º–æ–∂–µ –ø–æ—î–¥–Ω—É–≤–∞—Ç–∏ "–∫–∞–Ω–∞–ª–∏, —è–∫—ñ –¥–∏–≤–ª—è—Ç—å—Å—è –≤—Ä–∞–Ω—Ü—ñ + –º–∞—é—Ç—å –±–∞–≥–∞—Ç–æ–º–æ–≤–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É + –ø—Ä–æ —ñ–∑–æ—Ç–µ—Ä–∏–∫—É + –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ 25-30 —Ä–æ–∫—ñ–≤ + –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤ —è–∫–æ—Å—Ç—ñ —Ñ–æ–Ω–æ–≤–æ—ó –º—É–∑–∏–∫–∏ —Ç–µ—Ö–Ω–æ-—Ç—Ä–∞–Ω—Å". –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π, –∞–ª–µ –¥–∞—Ç–∏ –π–æ–º—É —á—ñ—Ç–∫—É –Ω–∞–∑–≤—É –≤–∞–∂–∫–æ.</p>

        <h3>2. –ö–æ-—Ü–∏—Ç—É–≤–∞–Ω–Ω—è ‚â† –°—Ö–æ–∂–∞ —Ç–µ–º–∞—Ç–∏–∫–∞</h3>
		<p>–ú–∞—Ç—Ä–∏—Ü—è <strong>Co-citation</strong> –¥–ª—è –∫–∞–Ω–∞–ª—ñ–≤ –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è —è–∫ <code>C = B·µÄ ¬∑ B</code>. –ï–ª–µ–º–µ–Ω—Ç <code>C[i][j]</code> —Ü—ñ—î—ó –º–∞—Ç—Ä–∏—Ü—ñ –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —á–∞—Å—Ç–æ –∫–∞–Ω–∞–ª–∏ 'i' —Ç–∞ 'j' "—Ü–∏—Ç—É—é—Ç—å—Å—è" (—Ç–æ–±—Ç–æ, –∑ –Ω–∏–º–∏ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å) –æ–¥–Ω—ñ –π —Ç—ñ —Å–∞–º—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ. –í–∏—Å–æ–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∫–∞–∑—É—î –Ω–∞ —Å–∏–ª—å–Ω–∏–π —Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –∫–∞–Ω–∞–ª–∞–º–∏ –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –≤–ø–æ–¥–æ–±–∞–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.</p>
        <p>–î—ñ–∞–≥–æ–Ω–∞–ª—å–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ <code>C[i][i]</code> –ø–æ–∫–∞–∑—É—é—Ç—å –∑–∞–≥–∞–ª—å–Ω—É "–ø–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å" –∫–∞–Ω–∞–ª—É 'i' —Å–µ—Ä–µ–¥ —É—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.</p>
        <p>–¢—ñ—Å–Ω–∏–π –∑–≤'—è–∑–æ–∫ —É –≥—Ä–∞—Ñ—ñ –∫–æ-—Ü–∏—Ç—É–≤–∞–Ω–Ω—è (–∫–æ–ª–∏ –¥–≤–∞ –∫–∞–Ω–∞–ª–∏ —á–∞—Å—Ç–æ –¥–∏–≤–ª—è—Ç—å—Å—è –æ–¥–Ω—ñ –π —Ç—ñ –∂ –ª—é–¥–∏) –º–æ–∂–µ –æ–∑–Ω–∞—á–∞—Ç–∏ —Ä—ñ–∑–Ω–µ:</p>
        <ul>
            <li><strong>–¢–µ–º–∞—Ç–∏—á–Ω–∞ —Å—Ö–æ–∂—ñ—Å—Ç—å:</strong> –æ–±–∏–¥–≤–∞ –∫–∞–Ω–∞–ª–∏ –ø—Ä–æ –º–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è.</li>
            <li><strong>–ê–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ñ—Å—Ç—å/–ü–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å:</strong> –æ–±–∏–¥–≤–∞ —î "must-see" –∫–∞–Ω–∞–ª–∞–º–∏ —É –ø–µ–≤–Ω—ñ–π –≥–∞–ª—É–∑—ñ.</li>
            <li><strong>–ö–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ñ—Å—Ç—å:</strong> –∫–∞–Ω–∞–ª–∏ —á–∞—Å—Ç–æ –∑–≥–∞–¥—É—é—Ç—å—Å—è —Ä–∞–∑–æ–º —è–∫ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏ –¥–æ –æ–¥–Ω—ñ—î—ó —Ç–µ–º–∏.</li>
        </ul>

        <h3>3. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π</h3>
        <p>–í–∏–±—ñ—Ä –º—ñ–∂ SVD —Ç–∞ –∫–æ-—Ü–∏—Ç—É–≤–∞–Ω–Ω—è–º –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –º–µ—Ç–∏.</p>

        <h4>SVD-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó ("–í–∞—Å –º–æ–∂–µ –∑–∞—Ü—ñ–∫–∞–≤–∏—Ç–∏...")</h4>
        <ul>
            <li><strong>–ü–µ—Ä–µ–≤–∞–≥–∏:</strong> –≤–∏—è–≤–ª—è—é—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ñ –∑–≤'—è–∑–∫–∏, –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ, –º–æ–∂—É—Ç—å –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–æ–≤—ñ —Å—Ñ–µ—Ä–∏ —ñ–Ω—Ç–µ—Ä–µ—Å—ñ–≤.</li>
            <li><strong>–ù–µ–¥–æ–ª—ñ–∫–∏:</strong> –º–µ–Ω—à –ø–æ—è—Å–Ω—é–≤–∞–Ω—ñ ("—á–æ—Ä–Ω–∞ —Å–∫—Ä–∏–Ω—å–∫–∞"), –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –±–∞–≥–∞—Ç–æ –¥–∞–Ω–∏—Ö –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è, —ñ–Ω–æ–¥—ñ –¥–∞—é—Ç—å –¥–∏–≤–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó.</li>
        </ul>

        <h4>–ö–æ-—Ü–∏—Ç—É–≤–∞–Ω–Ω—è ("–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, —â–æ –¥–∏–≤–ª—è—Ç—å—Å—è –•, —Ç–∞–∫–æ–∂ –¥–∏–≤–ª—è—Ç—å—Å—è Y...")</h4>
        <ul>
            <li><strong>–ü–µ—Ä–µ–≤–∞–≥–∏:</strong> —ñ–Ω—Ç—É—ó—Ç–∏–≤–Ω–æ –∑—Ä–æ–∑—É–º—ñ–ª—ñ, —Å–æ—Ü—ñ–∞–ª—å–Ω–æ –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω—ñ, –¥–æ–±—Ä–µ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞–≤—ñ—Ç—å –∑ –º–µ–Ω—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –¥–∞–Ω–∏—Ö.</li>
            <li><strong>–ù–µ–¥–æ–ª—ñ–∫–∏:</strong> –º–µ–Ω—à –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ, —Å—Ö–∏–ª—å–Ω—ñ –¥–æ "–µ—Ñ–µ–∫—Ç—É –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ" (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—å —Ç—ñ–ª—å–∫–∏ —Ç–µ, —â–æ –π —Ç–∞–∫ –ø–æ–ø—É–ª—è—Ä–Ω–µ), –æ–±–º–µ–∂–µ–Ω—ñ —ñ—Å–Ω—É—é—á–∏–º–∏ –∑–≤'—è–∑–∫–∞–º–∏.</li>
        </ul>

        <h4>–ü—Ä–∞–∫—Ç–∏—á–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ç–∞ –≥—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥</h4>
        <p>–ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–º —î –≥—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥, —â–æ –ø–æ—î–¥–Ω—É—î —Å–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏ –æ–±–æ—Ö –º–µ—Ç–æ–¥—ñ–≤:</p>
        <ul>
            <li><strong>SVD</strong> ‚Äî –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏—Ö —ñ–Ω—Ç–µ—Ä–µ—Å—ñ–≤ —Ç–∞ —Ä–∞–Ω–∂—É–≤–∞–Ω–Ω—è –∫–∞–Ω–¥–∏–¥–∞—Ç—ñ–≤.</li>
            <li><strong>–ö–æ-—Ü–∏—Ç—É–≤–∞–Ω–Ω—è</strong> ‚Äî –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –ø—Ä–æ–∑–æ—Ä–∏—Ö —Ç–∞ –∑—Ä–æ–∑—É–º—ñ–ª–∏—Ö –ø–æ—è—Å–Ω–µ–Ω—å –¥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π.</li>
        </ul>
        <p><strong>–ü—Ä–∏–∫–ª–∞–¥:</strong> "–†–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –≤–∞–º –∫–∞–Ω–∞–ª X (<em>SVD –≤–∏–∑–Ω–∞—á–∏–≤ –π–æ–≥–æ —è–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏–π</em>), —Ç–æ–º—É —â–æ 73% –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –¥–∏–≤–ª—è—Ç—å—Å—è –≤–∞—à —É–ª—é–±–ª–µ–Ω–∏–π –∫–∞–Ω–∞–ª Y, —Ç–∞–∫–æ–∂ –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –Ω–∞ X (<em>–∫–æ-—Ü–∏—Ç—É–≤–∞–Ω–Ω—è —è–∫ –ø–æ—è—Å–Ω–µ–Ω–Ω—è</em>)."</p>
    </div>
    <summary><strong>–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –¥–æ–≤—ñ–¥–∫–∞</strong></summary>
    <p><strong>–°–∏–Ω–≥—É–ª—è—Ä–Ω–∏–π —Ä–æ–∑–∫–ª–∞–¥ (SVD)</strong> –º–∞—Ç—Ä–∏—Ü—ñ —Å—É–º—ñ–∂–Ω–æ—Å—Ç—ñ –¥–≤–æ–¥–æ–ª—å–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ ‚Äî —Ü–µ —ó—ó —Ä–æ–∑–∫–ª–∞–¥ –Ω–∞ —Ç—Ä–∏ –º–∞—Ç—Ä–∏—Ü—ñ: B ‚âà U ¬∑ Œ£ ¬∑ V<sup>T</sup></p>
    <ul>
      <li><strong>B</strong> ‚Äî –≤–∏—Ö—ñ–¥–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è –≤–∑–∞—î–º–æ–¥—ñ–π "–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á-–∫–∞–Ω–∞–ª" (—Ä–æ–∑–º—ñ—Ä <em>m √ó n</em>).</li>
      <li><strong>U</strong> ‚Äî –º–∞—Ç—Ä–∏—Ü—è –≤–µ–∫—Ç–æ—Ä—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —É –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–º—É –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–Ω—Ç–µ—Ä–µ—Å—ñ–≤ (—Ä–æ–∑–º—ñ—Ä <em>m √ó k</em>). –ö–æ–∂–µ–Ω —Ä—è–¥–æ–∫ –æ–ø–∏—Å—É—î –æ–¥–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.</li>
      <li><strong>V</strong> ‚Äî –º–∞—Ç—Ä–∏—Ü—è –≤–µ–∫—Ç–æ—Ä—ñ–≤ –∫–∞–Ω–∞–ª—ñ–≤ —É —Ç–æ–º—É –∂ –ø—Ä–æ—Å—Ç–æ—Ä—ñ —ñ–Ω—Ç–µ—Ä–µ—Å—ñ–≤ (—Ä–æ–∑–º—ñ—Ä <em>n √ó k</em>). –ö–æ–∂–µ–Ω —Ä—è–¥–æ–∫ –æ–ø–∏—Å—É—î –æ–¥–∏–Ω –∫–∞–Ω–∞–ª.</li>
      <li><strong>Œ£</strong> (–°–∏–≥–º–∞) ‚Äî –¥—ñ–∞–≥–æ–Ω–∞–ª—å–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è "–≤–∞–≥" –∞–±–æ "—Å–∏–Ω–≥—É–ª—è—Ä–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å" (—Ä–æ–∑–º—ñ—Ä <em>k √ó k</em>). –í–æ–Ω–∞ –ø–æ–∫–∞–∑—É—î –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞.</li>
    </ul>
    <p>–°—É—Ç—å –º–µ—Ç–æ–¥—É: –º–∏ –∑–º–µ–Ω—à—É—î–º–æ —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å, –æ–±–∏—Ä–∞—é—á–∏ <strong>k</strong> –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö —Ñ–∞–∫—Ç–æ—Ä—ñ–≤. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —É–∑–∞–≥–∞–ª—å–Ω–∏—Ç–∏ –≤–ø–æ–¥–æ–±–∞–Ω–Ω—è —Ç–∞ –≤–∏—è–≤–∏—Ç–∏ –ø—Ä–∏—Ö–æ–≤–∞–Ω—ñ –∑–≤'—è–∑–∫–∏, —è–∫—ñ –Ω–µ —î –æ—á–µ–≤–∏–¥–Ω–∏–º–∏ —É –≤–∏—Ö—ñ–¥–Ω—ñ–π –º–∞—Ç—Ä–∏—Ü—ñ, —â–æ–± –Ω–∞ —ó—Ö –æ—Å–Ω–æ–≤—ñ –±—É–¥—É–≤–∞—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó.</p>
    <details>
      <summary><strong>–Ø–∫ –æ–±—á–∏—Å–ª—é—é—Ç—å—Å—è –º–∞—Ç—Ä–∏—Ü—ñ U, V —Ç–∞ Œ£?</strong></summary>
      <p><strong>Œ£ (–°–∏–Ω–≥—É–ª—è—Ä–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è):</strong> –î—ñ–∞–≥–æ–Ω–∞–ª—å–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ñ Œ£ —î –∫–≤–∞–¥—Ä–∞—Ç–Ω–∏–º–∏ –∫–æ—Ä–µ–Ω—è–º–∏ –≤–ª–∞—Å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å –º–∞—Ç—Ä–∏—Ü—ñ B¬∑B<sup>T</sup> (–∞–±–æ B<sup>T</sup>¬∑B). –í–æ–Ω–∏ –∑–∞–≤–∂–¥–∏ –Ω–µ–≤—ñ–¥'—î–º–Ω—ñ –π –≤–ø–æ—Ä—è–¥–∫–æ–≤—É—é—Ç—å—Å—è –∑–∞ —Å–ø–∞–¥–∞–Ω–Ω—è–º.</p>
      <p><strong>U (–õ—ñ–≤—ñ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ñ –≤–µ–∫—Ç–æ—Ä–∏):</strong> –°—Ç–æ–≤–ø—Ü—ñ –º–∞—Ç—Ä–∏—Ü—ñ U —î –≤–ª–∞—Å–Ω–∏–º–∏ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –º–∞—Ç—Ä–∏—Ü—ñ B¬∑B<sup>T</sup>. –í–æ–Ω–∏ —Ñ–æ—Ä–º—É—é—Ç—å –æ—Ä—Ç–æ–Ω–æ—Ä–º–æ–≤–∞–Ω–∏–π –±–∞–∑–∏—Å, —â–æ –æ–ø–∏—Å—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.</p>
      <p><strong>V (–ü—Ä–∞–≤—ñ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ñ –≤–µ–∫—Ç–æ—Ä–∏):</strong> –°—Ç–æ–≤–ø—Ü—ñ –º–∞—Ç—Ä–∏—Ü—ñ V —î –≤–ª–∞—Å–Ω–∏–º–∏ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –º–∞—Ç—Ä–∏—Ü—ñ B<sup>T</sup>¬∑B. –î–ª—è —É–∑–≥–æ–¥–∂–µ–Ω–Ω—è –∑–Ω–∞–∫—ñ–≤ –∑ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –∑ U, —ó—Ö –º–æ–∂–Ω–∞ –æ–±—á–∏—Å–ª–∏—Ç–∏ –∑–∞ —Ñ–æ—Ä–º—É–ª–æ—é: v<sub>i</sub> = (1/œÉ<sub>i</sub>) ¬∑ B<sup>T</sup> ¬∑ u<sub>i</sub>, –¥–µ u<sub>i</sub> —Ç–∞ v<sub>i</sub> ‚Äî –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ –º–∞—Ç—Ä–∏—Ü—å U —Ç–∞ V, –∞ œÉ<sub>i</sub> ‚Äî —Å–∏–Ω–≥—É–ª—è—Ä–Ω–µ —á–∏—Å–ª–æ.</p>
      
        <details>
            <summary><strong>–ü–æ—è—Å–Ω–µ–Ω–Ω—è –¥–ª—è –≥—ñ–∫—ñ–≤: –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ñ–æ—Ä–º—É–ª–∏ v<sub>i</sub> = (1/œÉ<sub>i</sub>)¬∑B<sup>T</sup>¬∑u<sub>i</sub></strong></summary>
            <p>–î–µ:<br>
            <b>v<sub>i</sub></b> ‚Äî i-–π –ø—Ä–∞–≤–∏–π —Å–∏–Ω–≥—É–ª—è—Ä–Ω–∏–π –≤–µ–∫—Ç–æ—Ä (—Å—Ç–æ–≤–ø–µ—Ü—å –º–∞—Ç—Ä–∏—Ü—ñ V).<br>
            <b>u<sub>i</sub></b> ‚Äî i-–π –ª—ñ–≤–∏–π —Å–∏–Ω–≥—É–ª—è—Ä–Ω–∏–π –≤–µ–∫—Ç–æ—Ä (—Å—Ç–æ–≤–ø–µ—Ü—å –º–∞—Ç—Ä–∏—Ü—ñ U).<br>
            <b>œÉ<sub>i</sub></b> ‚Äî i-—Ç–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è (–∑ –º–∞—Ç—Ä–∏—Ü—ñ Œ£).<br>
            <b>B<sup>T</sup></b> ‚Äî —Ç—Ä–∞–Ω—Å–ø–æ–Ω–æ–≤–∞–Ω–∞ –≤–∏—Ö—ñ–¥–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è.
            </p>
            
            <h4>–ü–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ñ–æ—Ä–º—É–ª–∏</h4>
            <p>–í—Å–µ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–≥–æ —Ä–æ–∑–∫–ª–∞–¥—É (SVD):</p>
            <p><b>1. –û—Å–Ω–æ–≤–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è SVD:</b><br>
            B = U ¬∑ Œ£ ¬∑ V<sup>T</sup></p>
            
            <p><b>2. –¢—Ä–∞–Ω—Å–ø–æ–Ω—É—î–º–æ –æ–±–∏–¥–≤—ñ —á–∞—Å—Ç–∏–Ω–∏ —Ä—ñ–≤–Ω—è–Ω–Ω—è:</b><br>
            –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª–æ (ABC)·µÄ = C·µÄB·µÄA·µÄ, –æ—Ç—Ä–∏–º—É—î–º–æ:<br>
            B<sup>T</sup> = (U ¬∑ Œ£ ¬∑ V<sup>T</sup>)<sup>T</sup><br>
            B<sup>T</sup> = (V<sup>T</sup>)<sup>T</sup> ¬∑ Œ£<sup>T</sup> ¬∑ U<sup>T</sup><br>
            –û—Å–∫—ñ–ª—å–∫–∏ (V<sup>T</sup>)<sup>T</sup> = V, –∞ –º–∞—Ç—Ä–∏—Ü—è Œ£ –¥—ñ–∞–≥–æ–Ω–∞–ª—å–Ω–∞ (—Ç–æ–±—Ç–æ Œ£<sup>T</sup> = Œ£), —Ä—ñ–≤–Ω—è–Ω–Ω—è —Å–ø—Ä–æ—â—É—î—Ç—å—Å—è –¥–æ:<br>
            <b>B<sup>T</sup> = V ¬∑ Œ£ ¬∑ U<sup>T</sup></b></p>
            
            <p><b>3. –î–æ–º–Ω–æ–∂–∏–º–æ –æ–±–∏–¥–≤—ñ —á–∞—Å—Ç–∏–Ω–∏ –Ω–∞ –º–∞—Ç—Ä–∏—Ü—é U —Å–ø—Ä–∞–≤–∞:</b><br>
            B<sup>T</sup> ¬∑ U = (V ¬∑ Œ£ ¬∑ U<sup>T</sup>) ¬∑ U<br>
            –ú–∞—Ç—Ä–∏—Ü—è U —î –æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω–æ—é, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ —ó—ó —Å—Ç–æ–≤–ø—Ü—ñ –æ—Ä—Ç–æ–Ω–æ—Ä–º–æ–≤–∞–Ω—ñ. –¢–æ–º—É –∑–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º, U<sup>T</sup>U = I (–æ–¥–∏–Ω–∏—á–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è).<br>
            B<sup>T</sup> ¬∑ U = V ¬∑ Œ£ ¬∑ I<br>
            <b>B<sup>T</sup> ¬∑ U = V ¬∑ Œ£</b></p>
            
            <p><b>4. –†–æ–∑–≥–ª—è–Ω–µ–º–æ —Ü–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è –ø–æ —Å—Ç–æ–≤–ø—Ü—è—Ö:</b><br>
            –î–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—å, —â–æ —è–≤–ª—è—î —Å–æ–±–æ—é i-–π —Å—Ç–æ–≤–ø–µ—Ü—å —É –º–∞—Ç—Ä–∏—Ü—è—Ö –∑–ª—ñ–≤–∞ —ñ —Å–ø—Ä–∞–≤–∞.<br>
            <ul>
                <li>i-–π —Å—Ç–æ–≤–ø–µ—Ü—å –¥–æ–±—É—Ç–∫—É B<sup>T</sup>U ‚Äî —Ü–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–Ω–æ–∂–µ–Ω–Ω—è –º–∞—Ç—Ä–∏—Ü—ñ B<sup>T</sup> –Ω–∞ i-–π —Å—Ç–æ–≤–ø–µ—Ü—å –º–∞—Ç—Ä–∏—Ü—ñ U, —Ç–æ–±—Ç–æ <b>B<sup>T</sup>u<sub>i</sub></b>.</li>
                <li>i-–π —Å—Ç–æ–≤–ø–µ—Ü—å –¥–æ–±—É—Ç–∫—É VŒ£ ‚Äî —Ü–µ i-–π —Å—Ç–æ–≤–ø–µ—Ü—å –º–∞—Ç—Ä–∏—Ü—ñ V (<b>v<sub>i</sub></b>), –ø–æ–º–Ω–æ–∂–µ–Ω–∏–π –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π i-–π –¥—ñ–∞–≥–æ–Ω–∞–ª—å–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç –º–∞—Ç—Ä–∏—Ü—ñ Œ£ (<b>œÉ<sub>i</sub></b>). –¢–æ–±—Ç–æ <b>œÉ<sub>i</sub>v<sub>i</sub></b>.</li>
            </ul>
            –ü—Ä–∏—Ä—ñ–≤–Ω—é—é—á–∏ —Ü—ñ –¥–≤–∞ –≤–∏—Ä–∞–∑–∏, –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ:<br>
            <b>B<sup>T</sup>u<sub>i</sub> = œÉ<sub>i</sub>v<sub>i</sub></b></p>
            
            <p><b>5. –í–∏—Ä–∞–∑–∏–º–æ v<sub>i</sub>:</b><br>
            –¢–µ–ø–µ—Ä, —è–∫—â–æ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è œÉ<sub>i</sub> –Ω–µ –¥–æ—Ä—ñ–≤–Ω—é—î –Ω—É–ª—é, –º–∏ –º–æ–∂–µ–º–æ –ø—Ä–æ—Å—Ç–æ –ø–æ–¥—ñ–ª–∏—Ç–∏ –æ–±–∏–¥–≤—ñ —á–∞—Å—Ç–∏–Ω–∏ —Ä—ñ–≤–Ω—è–Ω–Ω—è –Ω–∞ –Ω—å–æ–≥–æ:<br>
            <b>v<sub>i</sub> = (1/œÉ<sub>i</sub>) ¬∑ B<sup>T</sup>u<sub>i</sub></b></p>
            
            <h4>–ß–æ–º—É —Ü—è —Ñ–æ—Ä–º—É–ª–∞ –≤–∞–∂–ª–∏–≤–∞?</h4>
            <p>–¶—è —Ñ–æ—Ä–º—É–ª–∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∏–π —Ç—Ä—é–∫. –í–æ–Ω–∞ –º–∞—î –≤–µ–ª–∏–∫–µ –ø—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è:</p>
            <ul>
                <li><b>–£–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å –∑–Ω–∞–∫—ñ–≤:</b> –í–ª–∞—Å–Ω—ñ –≤–µ–∫—Ç–æ—Ä–∏ (–∑ —è–∫–∏—Ö —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –º–∞—Ç—Ä–∏—Ü—ñ U —Ç–∞ V) –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –∑ —Ç–æ—á–Ω—ñ—Å—Ç—é –¥–æ –∑–Ω–∞–∫–∞. –¢–æ–±—Ç–æ, —è–∫—â–æ <b>u</b> —î –≤–ª–∞—Å–Ω–∏–º –≤–µ–∫—Ç–æ—Ä–æ–º, —Ç–æ <b>-u</b> —Ç–∞–∫–æ–∂ —î –Ω–∏–º. –Ø–∫—â–æ –æ–±—á–∏—Å–ª—é–≤–∞—Ç–∏ U —Ç–∞ V –Ω–µ–∑–∞–ª–µ–∂–Ω–æ (—è–∫ –≤–ª–∞—Å–Ω—ñ –≤–µ–∫—Ç–æ—Ä–∏ –º–∞—Ç—Ä–∏—Ü—å BB·µÄ —Ç–∞ B·µÄB), —ó—Ö–Ω—ñ –∑–Ω–∞–∫–∏ –º–æ–∂—É—Ç—å –≤–∏—è–≤–∏—Ç–∏—Å—è –Ω–µ—É–∑–≥–æ–¥–∂–µ–Ω–∏–º–∏, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–æ–∑–∫–ª–∞–¥—É. –¶—è —Ñ–æ—Ä–º—É–ª–∞ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –∑–Ω–∞–∫–∏ –≤–µ–∫—Ç–æ—Ä—ñ–≤ u<sub>i</sub> —Ç–∞ v<sub>i</sub> –±—É–¥—É—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–æ –ø–æ–≤'—è–∑–∞–Ω—ñ –º—ñ–∂ —Å–æ–±–æ—é.</li>
                <li><b>–û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:</b> –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–≤—ñ –æ–∫—Ä–µ–º—ñ (—ñ –¥–æ—Ä–æ–≥—ñ) –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –ø–æ—à—É–∫—É –≤–ª–∞—Å–Ω–∏—Ö –≤–µ–∫—Ç–æ—Ä—ñ–≤ –¥–ª—è –¥–≤–æ—Ö —Ä—ñ–∑–Ω–∏—Ö –º–∞—Ç—Ä–∏—Ü—å, –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤–ª–∞—Å–Ω—ñ –≤–µ–∫—Ç–æ—Ä–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è –æ–¥–Ω—ñ—î—ó –∑ –Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, u<sub>i</sub>), –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü—é –ø—Ä–æ—Å—Ç—É —Ñ–æ—Ä–º—É–ª—É –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≤–µ–∫—Ç–æ—Ä—ñ–≤ –¥–ª—è —ñ–Ω—à–æ—ó –º–∞—Ç—Ä–∏—Ü—ñ (v<sub>i</sub>).</li>
            </ul>
        </details>
       <p>–î–ª—è –∞–ø—Ä–æ–∫—Å–∏–º–∞—Ü—ñ—ó –º–∏ –æ–±–∏—Ä–∞—î–º–æ –ª–∏—à–µ –ø–µ—Ä—à—ñ <em>k</em> –Ω–∞–π–±—ñ–ª—å—à–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —ó–º –≤–µ–∫—Ç–æ—Ä–∏ –∑ –º–∞—Ç—Ä–∏—Ü—å U —Ç–∞ V.</p>
    </details>
     <details>
        <summary><strong>–©–æ —Ç–∞–∫–µ Co-citation –º–µ—Ä–µ–∂–∞?</strong></summary>
        <p>–ú–∞—Ç—Ä–∏—Ü—è <strong>Co-citation</strong> –¥–ª—è –∫–∞–Ω–∞–ª—ñ–≤ –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è —è–∫ C = B<sup>T</sup> ¬∑ B. –ï–ª–µ–º–µ–Ω—Ç C[i][j] —Ü—ñ—î—ó –º–∞—Ç—Ä–∏—Ü—ñ –ø–æ–∫–∞–∑—É—î, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —á–∞—Å—Ç–æ –∫–∞–Ω–∞–ª–∏ 'i' —Ç–∞ 'j' "—Ü–∏—Ç—É—é—Ç—å—Å—è" (—Ç–æ–±—Ç–æ, –∑ –Ω–∏–º–∏ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å) –æ–¥–Ω—ñ –π —Ç—ñ —Å–∞–º—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ. –í–∏—Å–æ–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–∫–∞–∑—É—î –Ω–∞ —Å–∏–ª—å–Ω–∏–π —Ç–µ–º–∞—Ç–∏—á–Ω–∏–π –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –∫–∞–Ω–∞–ª–∞–º–∏ –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –≤–ø–æ–¥–æ–±–∞–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.</p>
        <p>–î—ñ–∞–≥–æ–Ω–∞–ª—å–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ C[i][i] –ø–æ–∫–∞–∑—É—é—Ç—å –∑–∞–≥–∞–ª—å–Ω—É "–ø–æ–ø—É–ª—è—Ä–Ω—ñ—Å—Ç—å" –∫–∞–Ω–∞–ª—É 'i' —Å–µ—Ä–µ–¥ —É—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.</p>
    </details>
  </details>

<script>
  let userCount = 5, channelCount = 3;

  document.addEventListener('DOMContentLoaded', () => {
    document.getElementById("threshold").oninput = e => {
      document.getElementById("threshVal").textContent = e.target.value;
    };
    generateMatrix();
  });

  function generateMatrix() {
    userCount = +document.getElementById("userCount").value;
    channelCount = +document.getElementById("channelCount").value;
    const binary = document.getElementById("binaryMode").checked;

    let html = '<h3>–í—Ö—ñ–¥–Ω–∞ –º–∞—Ç—Ä–∏—Ü—è B (–≤–∑–∞—î–º–æ–¥—ñ—ó)</h3><table id="input-matrix"><thead><tr><th></th>';
    for (let j = 0; j < channelCount; j++) html += `<th>–ö–∞–Ω–∞–ª ${j+1}</th>`;
    html += '</tr></thead><tbody>';
    for (let i = 0; i < userCount; i++) {
      html += `<tr><th>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á ${i+1}</th>`;
      for (let j = 0; j < channelCount; j++) {
        const inputAttrs = binary ? 'max="1" step="1"' : 'max="10" step="0.1"';
        html += `<td><input type="number" min="0" ${inputAttrs} value="0"></td>`;
      }
      html += '</tr>';
    }
    html += '</tbody></table>';
    document.getElementById("matrix-container").innerHTML = html;
    
    const maxK = Math.min(userCount, channelCount);
    const kInput = document.getElementById("latentFactors");
    kInput.max = maxK;
    if (+kInput.value > maxK) {
        kInput.value = maxK;
    }
  }

  function randomizeMatrix() {
    const binary = document.getElementById("binaryMode").checked;
    document.querySelectorAll("#input-matrix input").forEach(input => {
      if (binary) {
          input.value = Math.round(Math.random());
      } else {
          input.value = Math.random() > 0.45 ? (Math.random() * 10).toFixed(1) : 0;
      }
    });
  }

  function factorize() {
    const inputs = document.querySelectorAll("#input-matrix input");
    const B = Array.from({ length: userCount }, () => []);
    inputs.forEach((el, idx) => {
      const r = Math.floor(idx / channelCount);
      B[r].push(+el.value);
    });

    if (numeric.norm2(B) === 0) {
        alert("–ú–∞—Ç—Ä–∏—Ü—è –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é –Ω—É–ª—å–æ–≤–æ—é. –î–æ–¥–∞–π—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è.");
        return;
    }

    // SVD Calculation
    const svd = numeric.svd(B);
    const { U, S, V } = svd;
    const k = Math.min(+document.getElementById("latentFactors").value, Math.min(userCount, channelCount));
     if (k <= 0) {
        alert("–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ–∞–∫—Ç–æ—Ä—ñ–≤ (k) –º–∞—î –±—É—Ç–∏ –¥–æ–¥–∞—Ç–Ω—ñ–º —á–∏—Å–ª–æ–º.");
        return;
    }
    const U_k = U.map(row => row.slice(0, k));
    const V_k = V.map(row => row.slice(0, k));
    
    // Adjust signs for better interpretability
    for (let j = 0; j < k; j++) {
        let u_col_sum = 0;
        for (let i = 0; i < U_k.length; i++) {
            u_col_sum += U_k[i][j];
        }
        
        if (u_col_sum < 0) {
            for (let i = 0; i < U_k.length; i++) { U_k[i][j] *= -1; }
            for (let i = 0; i < V_k.length; i++) { V_k[i][j] *= -1; }
        }
    }

    const S_k_diag = S.slice(0, k);
    const S_k_matrix = numeric.diag(S_k_diag);
    const B_approx = numeric.dot(U_k, numeric.dot(S_k_matrix, numeric.transpose(V_k)));


    drawGraph(B);

    let resultHTML = '<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –§–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó</h3><div style="display: flex; flex-wrap: wrap; gap: 2rem">';
    resultHTML += renderMatrix(B, "–û—Ä–∏–≥—ñ–Ω–∞–ª (B)");
    resultHTML += renderMatrix(B_approx, "–ù–∞–±–ª–∏–∂–µ–Ω–∞ (B ‚âà UŒ£V·µÄ)", B);
    resultHTML += '</div><hr><div style="display: flex; flex-wrap: wrap; gap: 2rem">';
    resultHTML += "<div><h3>Œ£ (–í–∞–≥–∏ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤)</h3>" + renderSigmaMatrix(S_k_diag) + "</div>";
    resultHTML += "<div><h3>U (–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ)</h3>" + renderLabeledMatrix(U_k, "U", "–§–∞–∫—Ç–æ—Ä") + "</div>";
    resultHTML += "<div><h3>V (–ö–∞–Ω–∞–ª–∏)</h3>" + renderLabeledMatrix(V_k, "C", "–§–∞–∫—Ç–æ—Ä") + "</div>";
    resultHTML += '</div><hr>';
    resultHTML += "<h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:</h3><pre>" + renderComments(B, B_approx) + "</pre>";
    document.getElementById("results").innerHTML = resultHTML;
      
    // Co-citation Calculation & Rendering
    const B_T = numeric.transpose(B);
    const coCitationMatrix = numeric.dot(B_T, B);
    drawCoCitationGraph(coCitationMatrix);
    document.getElementById("coCitationResults").innerHTML = renderLabeledMatrix(coCitationMatrix, "C", "–°", true);
  }

  function renderMatrix(M, title, ref = null) {
    const threshold = parseFloat(document.getElementById("threshold").value);
    let html = `<div><strong>${title}</strong><table><tbody>`;
    for (let i = 0; i < M.length; i++) {
      html += "<tr>";
      for (let j = 0; j < M[0].length; j++) {
        let cls = "";
        let val = M[i][j];
        if (ref) {
          if (ref[i][j] === 0 && val > threshold) cls = "highlight";
          else if (ref[i][j] > 0 && val > ref[i][j] + 0.2) cls = "increase";
          val = val.toFixed(2);
        } else {
            val = val.toFixed(1);
        }
        html += `<td class="${cls}">${val}</td>`;
      }
      html += "</tr>";
    }
    return html + "</tbody></table></div>";
  }

  function renderSigmaMatrix(S_values) {
    const k = S_values.length;
    let html = '<table><tbody>';
    for (let i = 0; i < k; i++) {
        html += "<tr>";
        for (let j = 0; j < k; j++) {
            const val = (i === j) ? S_values[i].toFixed(2) : "0.00";
            html += `<td>${val}</td>`;
        }
        html += "</tr>";
    }
    return html + "</tbody></table>";
  }
    
  function renderLabeledMatrix(M, rowPrefix, colPrefix, isCoCitation = false) {
    let title = isCoCitation ? '–ú–∞—Ç—Ä–∏—Ü—è Co-citation (B·µÄB)' : '';
    let html = `<div><strong>${title}</strong><table><thead><tr><th></th>`;
    for (let j = 0; j < M[0].length; j++) html += `<th>${colPrefix} ${j + 1}</th>`;
    html += '</tr></thead><tbody>';
    for (let i = 0; i < M.length; i++) {
      html += `<tr><th>${rowPrefix}${i + 1}</th>`;
      for (let j = 0; j < M[0].length; j++) {
        const val = M[i][j];
        const displayVal = (isCoCitation && val % 1 === 0) ? val : val.toFixed(2);
        html += `<td>${displayVal}</td>`;
      }
      html += '</tr>';
    }
    return html + '</tbody></table></div>';
  }
  
  function renderComments(B, B_approx) {
    const threshold = parseFloat(document.getElementById("threshold").value);
    let out = "";
    for (let i = 0; i < B.length; i++) {
      for (let j = 0; j < B[0].length; j++) {
        const originalVal = B[i][j];
        const approxVal = B_approx[i][j];
        if (originalVal === 0 && approxVal > threshold) {
            out += `üü• U${i + 1} ‚Üí C${j + 1}: –ù–æ–≤–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è. –ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–∏–π —ñ–Ω—Ç–µ—Ä–µ—Å: ${approxVal.toFixed(2)}\n`;
        } else if (originalVal > 0 && approxVal > originalVal + 0.2) {
            out += `üü© U${i + 1} ‚Üí C${j + 1}: –ó—Ä–æ—Å—Ç–∞–Ω–Ω—è —ñ–Ω—Ç–µ—Ä–µ—Å—É. –ë—É–ª–æ ${originalVal.toFixed(1)}, –ø—Ä–æ–≥–Ω–æ–∑ ${approxVal.toFixed(2)}\n`;
        }
      }
    }
    return out || "–ù–µ–º–∞—î –Ω–æ–≤–∏—Ö —á–∏ –ø–æ—Å–∏–ª–µ–Ω–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π –∑–∞ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø–æ—Ä–æ–≥—É.";
  }

  function drawGraph(B) {
    const canvas = document.getElementById("graph");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const userYStep = canvas.height / (B.length + 1);
    const channelYStep = canvas.height / (B[0].length + 1);
    const users = B.map((_, i) => [100, userYStep * (i + 1)]);
    const channels = B[0].map((_, j) => [canvas.width - 100, channelYStep * (j + 1)]);

    ctx.font = "14px sans-serif";
	
	 for (let i = 0; i < B.length; i++) {
      for (let j = 0; j < B[0].length; j++) {
        const weight = B[i][j];
        if (weight > 0) {
          const [x1, y1] = users[i];
          const [x2, y2] = channels[j];
          ctx.beginPath();
          ctx.moveTo(x1, y1); ctx.lineTo(x2, y2);
          ctx.lineWidth = 1 + weight;
          ctx.strokeStyle = `rgba(85, 85, 85, ${Math.min(0.2 + weight * 0.1, 1)})`;
          ctx.stroke();
        }
      }
    }
	
    users.forEach(([x, y], i) => {
	ctx.lineWidth = 1;
      ctx.beginPath(); ctx.arc(x, y, 18, 0, 2 * Math.PI);
      ctx.fillStyle = "#cce"; ctx.fill(); ctx.strokeStyle = "#007bff"; ctx.stroke();
      ctx.fillStyle = "#000"; ctx.textAlign = "center"; ctx.textBaseline = "middle"; ctx.fillText("U" + (i + 1), x, y);
    });

    channels.forEach(([x, y], j) => {
	ctx.lineWidth = 1;
      ctx.beginPath(); ctx.arc(x, y, 18, 0, 2 * Math.PI);
      ctx.fillStyle = "#ecc"; ctx.fill(); ctx.strokeStyle = "#dc3545"; ctx.stroke();
      ctx.fillStyle = "#000"; ctx.textAlign = "center"; ctx.textBaseline = "middle"; ctx.fillText("C" + (j + 1), x, y);
    });

   
  }
    
  function drawCoCitationGraph(matrix) {
    const canvas = document.getElementById("coCitationGraph");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const numChannels = matrix.length;
    const radius = canvas.width / 2 - 40;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
      
    const channelNodes = [];
    for (let i = 0; i < numChannels; i++) {
        const angle = (i / numChannels) * 2 * Math.PI - Math.PI / 2;
        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);
        channelNodes.push([x, y]);
    }

    let maxWeight = 1;
    for (let i = 0; i < numChannels; i++) {
        for (let j = i + 1; j < numChannels; j++) {
            if (matrix[i][j] > maxWeight) maxWeight = matrix[i][j];
        }
    }

    for (let i = 0; i < numChannels; i++) {
        for (let j = i + 1; j < numChannels; j++) {
            const weight = matrix[i][j];
            if (weight > 0) {
                const [x1, y1] = channelNodes[i];
                const [x2, y2] = channelNodes[j];
                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.lineWidth = Math.max(1, (weight / maxWeight) * 10);
                ctx.strokeStyle = `rgba(85, 85, 85, ${Math.min(0.1 + weight / maxWeight, 1)})`;
                ctx.stroke();
            }
        }
    }
      
    let maxDiagonal = 1;
    matrix.forEach((row, i) => { if(row[i] > maxDiagonal) maxDiagonal = row[i]; });

    ctx.font = "14px sans-serif";
    channelNodes.forEach(([x, y], i) => {
	    const wght = matrix[i][i];
        ctx.beginPath();
        ctx.arc(x, y, 18, 0, 2 * Math.PI);
        ctx.fillStyle = "#ecc";
        ctx.fill();
        ctx.strokeStyle = "#dc3545";
		ctx.lineWidth = Math.max(1, (wght/maxDiagonal) * 8);
        ctx.stroke();
        ctx.fillStyle = "#000";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText("C" + (i + 1), x, y);
    });
  }

</script>
</body>
</html>